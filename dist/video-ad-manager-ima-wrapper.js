var adserve;(()=>{"use strict";var e={d:(t,i)=>{for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{tv:()=>c});const i=function(e,t,i){this.message=e,this.errorCode=t,this.innerError=i};i.prototype.getMessage=function(){return this.message},i.prototype.getErrorCode=function(){return this.errorCode},i.prototype.getInnerError=function(){return this.innerError instanceof Object?this.innerError:null},i.prototype.formatMessage=function(...e){return this.message=function(e,...t){try{t.forEach(((t,i)=>{e=e.replace(new RegExp("\\{"+i+"}","g"),t)}))}catch(e){}return e}(this.message,e),this},i.prototype.toString=function(){return"AdError "+this.getErrorCode()+": "+this.getMessage()+(null!=this.getInnerError()?" Caused by: "+this.getInnerError():"")};const n=i;var r={686:function(e,t){!function(e){function t(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function i(e){for(var i=1;i<arguments.length;i++){var n=null!=arguments[i]?arguments[i]:{};i%2?t(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function u(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=l(e);if(t){var r=l(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return u(this,i)}}function p(e){return function(e){if(Array.isArray(e))return A(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return A(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?A(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,adId:e.adId||null,sequence:e.sequence||null,apiFramework:e.apiFramework||null,universalAdIds:[],creativeExtensions:[]}}var m=["ADCATEGORIES","ADCOUNT","ADPLAYHEAD","ADSERVINGID","ADTYPE","APIFRAMEWORKS","APPBUNDLE","ASSETURI","BLOCKEDADCATEGORIES","BREAKMAXADLENGTH","BREAKMAXADS","BREAKMAXDURATION","BREAKMINADLENGTH","BREAKMINDURATION","BREAKPOSITION","CLICKPOS","CLICKTYPE","CLIENTUA","CONTENTID","CONTENTPLAYHEAD","CONTENTURI","DEVICEIP","DEVICEUA","DOMAIN","EXTENSIONS","GDPRCONSENT","IFA","IFATYPE","INVENTORYSTATE","LATLONG","LIMITADTRACKING","MEDIAMIME","MEDIAPLAYHEAD","OMIDPARTNER","PAGEURL","PLACEMENTTYPE","PLAYERCAPABILITIES","PLAYERSIZE","PLAYERSTATE","PODSEQUENCE","REGULATIONS","SERVERSIDE","SERVERUA","TRANSACTIONID","UNIVERSALADID","VASTVERSIONS","VERIFICATIONVENDORS"];function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=[],r=T(e);for(var a in!t.ERRORCODE||i.isCustomCode||/^[0-9]{3}$/.test(t.ERRORCODE)||(t.ERRORCODE=900),t.CACHEBUSTING=C(Math.round(1e8*Math.random()).toString()),t.TIMESTAMP=(new Date).toISOString(),t.RANDOM=t.random=t.CACHEBUSTING,t)t[a]=S(t[a]);for(var s in r){var o=r[s];"string"==typeof o&&n.push(g(o,t))}return n}function g(e,t){var i=(e=f(e,t)).match(/[^[\]]+(?=])/g);if(!i)return e;var n=i.filter((function(e){return m.indexOf(e)>-1}));return 0===n.length?e:f(e,n=n.reduce((function(e,t){return e[t]=-1,e}),{}))}function f(e,t){var i=e;for(var n in t){var r=t[n];i=i.replace(new RegExp("(?:\\[|%%)(".concat(n,")(?:\\]|%%)"),"g"),r)}return i}function T(e){return Array.isArray(e)?e.map((function(e){return e&&e.hasOwnProperty("url")?e.url:e})):e}function _(e,t){for(var i=0;i<t.length;i++)if(y(t[i],e))return!0;return!1}function y(e,t){if(e&&t){var i=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(t);return i.length===n.length&&e.id===t.id&&e.url===t.url}return!1}function S(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%".concat(e.charCodeAt(0).toString(16))}))}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,i=String(e);return i.length<t?k(0,t-i.length,!1).map((function(){return"0"})).join("")+i:i}function k(e,t,i){for(var n=[],r=e<t,a=i?r?t+1:t-1:t,s=e;r?s<a:s>a;r?s++:s--)n.push(s);return n}var V={track:function(e,t,i){E(e,t,i).forEach((function(e){"undefined"!=typeof window&&null!==window&&((new Image).src=e)}))},resolveURLTemplates:E,extractURLsFromTemplates:T,containsTemplateObject:_,isTemplateObjectEqual:y,encodeURIComponentRFC3986:S,replaceUrlMacros:g,leftpad:C,range:k,isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},flatten:function e(t){return t.reduce((function(t,i){return t.concat(Array.isArray(i)?e(i):i)}),[])},joinArrayOfUniqueTemplateObjs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=Array.isArray(e)?e:[],n=Array.isArray(t)?t:[];return i.concat(n).reduce((function(e,t){return _(t,e)||e.push(t),e}),[])}};function b(e){return-1!==["true","TRUE","True","1"].indexOf(e)}var R={childByName:function(e,t){var i=e.childNodes;for(var n in i){var r=i[n];if(r.nodeName===t)return r}},childrenByName:function(e,t){var i=[],n=e.childNodes;for(var r in n){var a=n[r];a.nodeName===t&&i.push(a)}return i},resolveVastAdTagURI:function(e,t){if(!t)return e;if(0===e.indexOf("//")){var i=location.protocol;return"".concat(i).concat(e)}if(-1===e.indexOf("://")){var n=t.slice(0,t.lastIndexOf("/"));return"".concat(n,"/").concat(e)}return e},parseBoolean:b,parseNodeText:function(e){return e&&(e.textContent||e.text||"").trim()},copyNodeAttribute:function(e,t,i){var n=t.getAttribute(e);n&&i.setAttribute(e,n)},parseAttributes:function(e){for(var t=e.attributes,i={},n=0;n<t.length;n++)i[t[n].nodeName]=t[n].nodeValue;return i},parseDuration:function(e){if(null==e)return-1;if(V.isNumeric(e))return parseInt(e);var t=e.split(":");if(3!==t.length)return-1;var i=t[2].split("."),n=parseInt(i[0]);2===i.length&&(n+=parseFloat("0.".concat(i[1])));var r=parseInt(60*t[1]),a=parseInt(60*t[0]*60);return isNaN(a)||isNaN(r)||isNaN(n)||r>3600||n>60?-1:a+r+n},splitVAST:function(e){var t=[],i=null;return e.forEach((function(n,r){if(n.sequence&&(n.sequence=parseInt(n.sequence,10)),n.sequence>1){var a=e[r-1];if(a&&a.sequence===n.sequence-1)return void(i&&i.push(n));delete n.sequence}i=[n],t.push(i)})),t},assignAttributes:function(e,t){if(e)for(var i in e){var n=e[i];if(n.nodeName&&n.nodeValue&&t.hasOwnProperty(n.nodeName)){var r=n.nodeValue;"boolean"==typeof t[n.nodeName]&&(r=b(r)),t[n.nodeName]=r}}},mergeWrapperAdData:function(e,t){e.errorURLTemplates=t.errorURLTemplates.concat(e.errorURLTemplates),e.impressionURLTemplates=t.impressionURLTemplates.concat(e.impressionURLTemplates),e.extensions=t.extensions.concat(e.extensions),t.viewableImpression.length>0&&(e.viewableImpression=[].concat(p(e.viewableImpression),p(t.viewableImpression))),e.followAdditionalWrappers=t.followAdditionalWrappers,e.allowMultipleAds=t.allowMultipleAds,e.fallbackOnNoAd=t.fallbackOnNoAd;var i=(t.creatives||[]).filter((function(e){return e&&"companion"===e.type})),n=i.reduce((function(e,t){return(t.variations||[]).forEach((function(t){(t.companionClickTrackingURLTemplates||[]).forEach((function(t){V.containsTemplateObject(t,e)||e.push(t)}))})),e}),[]);e.creatives=i.concat(e.creatives);var r=t.videoClickTrackingURLTemplates&&t.videoClickTrackingURLTemplates.length,a=t.videoCustomClickURLTemplates&&t.videoCustomClickURLTemplates.length;e.creatives.forEach((function(e){if(t.trackingEvents&&t.trackingEvents[e.type])for(var i in t.trackingEvents[e.type]){var s=t.trackingEvents[e.type][i];Array.isArray(e.trackingEvents[i])||(e.trackingEvents[i]=[]),e.trackingEvents[i]=e.trackingEvents[i].concat(s)}"linear"===e.type&&(r&&(e.videoClickTrackingURLTemplates=e.videoClickTrackingURLTemplates.concat(t.videoClickTrackingURLTemplates)),a&&(e.videoCustomClickURLTemplates=e.videoCustomClickURLTemplates.concat(t.videoCustomClickURLTemplates)),!t.videoClickThroughURLTemplate||null!==e.videoClickThroughURLTemplate&&void 0!==e.videoClickThroughURLTemplate||(e.videoClickThroughURLTemplate=t.videoClickThroughURLTemplate)),"companion"===e.type&&n.length&&(e.variations||[]).forEach((function(e){e.companionClickTrackingURLTemplates=V.joinArrayOfUniqueTemplateObjs(e.companionClickTrackingURLTemplates,n)}))})),t.adVerifications&&(e.adVerifications=e.adVerifications.concat(t.adVerifications)),t.blockedAdCategories&&(e.blockedAdCategories=e.blockedAdCategories.concat(t.blockedAdCategories))}};function L(e,t){var i=function(){var e=v(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return{id:e.id,adId:e.adId,sequence:e.sequence,apiFramework:e.apiFramework,type:"companion",required:null,variations:[]}}(t);return i.required=e.getAttribute("required")||null,i.variations=R.childrenByName(e,"Companion").map((function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,adType:"companionAd",width:e.width||0,height:e.height||0,assetWidth:e.assetWidth||null,assetHeight:e.assetHeight||null,expandedWidth:e.expandedWidth||null,expandedHeight:e.expandedHeight||null,apiFramework:e.apiFramework||null,adSlotID:e.adSlotID||null,pxratio:e.pxratio||"1",renderingMode:e.renderingMode||"default",staticResources:[],htmlResources:[],iframeResources:[],adParameters:null,xmlEncoded:null,altText:null,companionClickThroughURLTemplate:null,companionClickTrackingURLTemplates:[],trackingEvents:{}}}(R.parseAttributes(e));t.htmlResources=R.childrenByName(e,"HTMLResource").reduce((function(e,t){var i=R.parseNodeText(t);return i?e.concat(i):e}),[]),t.iframeResources=R.childrenByName(e,"IFrameResource").reduce((function(e,t){var i=R.parseNodeText(t);return i?e.concat(i):e}),[]),t.staticResources=R.childrenByName(e,"StaticResource").reduce((function(e,t){var i=R.parseNodeText(t);return i?e.concat({url:i,creativeType:t.getAttribute("creativeType")||null}):e}),[]),t.altText=R.parseNodeText(R.childByName(e,"AltText"))||null;var i=R.childByName(e,"TrackingEvents");i&&R.childrenByName(i,"Tracking").forEach((function(e){var i=e.getAttribute("event"),n=R.parseNodeText(e);i&&n&&(Array.isArray(t.trackingEvents[i])||(t.trackingEvents[i]=[]),t.trackingEvents[i].push(n))})),t.companionClickTrackingURLTemplates=R.childrenByName(e,"CompanionClickTracking").map((function(e){return{id:e.getAttribute("id")||null,url:R.parseNodeText(e)}})),t.companionClickThroughURLTemplate=R.parseNodeText(R.childByName(e,"CompanionClickThrough"))||null;var n=R.childByName(e,"AdParameters");return n&&(t.adParameters=R.parseNodeText(n),t.xmlEncoded=n.getAttribute("xmlEncoded")||null),t})),i}function N(e){return"linear"===e.type}function I(e,t){var i,n=function(){var e=v(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return{id:e.id,adId:e.adId,sequence:e.sequence,apiFramework:e.apiFramework,type:"linear",duration:0,skipDelay:null,mediaFiles:[],mezzanine:null,interactiveCreativeFile:null,closedCaptionFiles:[],videoClickThroughURLTemplate:null,videoClickTrackingURLTemplates:[],videoCustomClickURLTemplates:[],adParameters:null,icons:[],trackingEvents:{}}}(t);n.duration=R.parseDuration(R.parseNodeText(R.childByName(e,"Duration")));var r=e.getAttribute("skipoffset");if(null==r)n.skipDelay=null;else if("%"===r.charAt(r.length-1)&&-1!==n.duration){var a=parseInt(r,10);n.skipDelay=n.duration*(a/100)}else n.skipDelay=R.parseDuration(r);var s=R.childByName(e,"VideoClicks");if(s){var o=R.childByName(s,"ClickThrough");n.videoClickThroughURLTemplate=o?{id:o.getAttribute("id")||null,url:R.parseNodeText(o)}:null,R.childrenByName(s,"ClickTracking").forEach((function(e){n.videoClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:R.parseNodeText(e)})})),R.childrenByName(s,"CustomClick").forEach((function(e){n.videoCustomClickURLTemplates.push({id:e.getAttribute("id")||null,url:R.parseNodeText(e)})}))}var d=R.childByName(e,"AdParameters");d&&(n.adParameters=R.parseNodeText(d)),R.childrenByName(e,"TrackingEvents").forEach((function(e){R.childrenByName(e,"Tracking").forEach((function(e){var t=e.getAttribute("event"),r=R.parseNodeText(e);if(t&&r){if("progress"===t){if(!(i=e.getAttribute("offset")))return;t="%"===i.charAt(i.length-1)?"progress-".concat(i):"progress-".concat(Math.round(R.parseDuration(i)))}Array.isArray(n.trackingEvents[t])||(n.trackingEvents[t]=[]),n.trackingEvents[t].push(r)}}))})),R.childrenByName(e,"MediaFiles").forEach((function(e){R.childrenByName(e,"MediaFile").forEach((function(e){n.mediaFiles.push(function(e){var t={id:null,fileURL:null,fileSize:0,deliveryType:"progressive",mimeType:null,mediaType:null,codec:null,bitrate:0,minBitrate:0,maxBitrate:0,width:0,height:0,apiFramework:null,scalable:null,maintainAspectRatio:null};t.id=e.getAttribute("id"),t.fileURL=R.parseNodeText(e),t.deliveryType=e.getAttribute("delivery"),t.codec=e.getAttribute("codec"),t.mimeType=e.getAttribute("type"),t.mediaType=e.getAttribute("mediaType")||"2D",t.apiFramework=e.getAttribute("apiFramework"),t.fileSize=parseInt(e.getAttribute("fileSize")||0),t.bitrate=parseInt(e.getAttribute("bitrate")||0),t.minBitrate=parseInt(e.getAttribute("minBitrate")||0),t.maxBitrate=parseInt(e.getAttribute("maxBitrate")||0),t.width=parseInt(e.getAttribute("width")||0),t.height=parseInt(e.getAttribute("height")||0);var i=e.getAttribute("scalable");i&&"string"==typeof i&&(t.scalable=R.parseBoolean(i));var n=e.getAttribute("maintainAspectRatio");return n&&"string"==typeof n&&(t.maintainAspectRatio=R.parseBoolean(n)),t}(e))}));var t=R.childByName(e,"InteractiveCreativeFile");t&&(n.interactiveCreativeFile=function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:e.type||null,apiFramework:e.apiFramework||null,variableDuration:R.parseBoolean(e.variableDuration),fileURL:null}}(R.parseAttributes(e));return t.fileURL=R.parseNodeText(e),t}(t));var i=R.childByName(e,"ClosedCaptionFiles");i&&R.childrenByName(i,"ClosedCaptionFile").forEach((function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:e.type||null,language:e.language||null,fileURL:null}}(R.parseAttributes(e));t.fileURL=R.parseNodeText(e),n.closedCaptionFiles.push(t)}));var r,a,s,o=R.childByName(e,"Mezzanine"),d=(r=o,a={},s=!1,["delivery","type","width","height"].forEach((function(e){r&&r.getAttribute(e)?a[e]=r.getAttribute(e):s=!0})),s?null:a);if(d){var l={id:null,fileURL:null,delivery:null,codec:null,type:null,width:0,height:0,fileSize:0,mediaType:"2D"};l.id=o.getAttribute("id"),l.fileURL=R.parseNodeText(o),l.delivery=d.delivery,l.codec=o.getAttribute("codec"),l.type=d.type,l.width=parseInt(d.width,10),l.height=parseInt(d.height,10),l.fileSize=parseInt(o.getAttribute("fileSize"),10),l.mediaType=o.getAttribute("mediaType")||"2D",n.mezzanine=l}}));var l=R.childByName(e,"Icons");return l&&R.childrenByName(l,"Icon").forEach((function(e){n.icons.push(function(e){var t={program:null,height:0,width:0,xPosition:0,yPosition:0,apiFramework:null,offset:null,duration:0,type:null,staticResource:null,htmlResource:null,iframeResource:null,pxratio:"1",iconClickThroughURLTemplate:null,iconClickTrackingURLTemplates:[],iconViewTrackingURLTemplate:null};t.program=e.getAttribute("program"),t.height=parseInt(e.getAttribute("height")||0),t.width=parseInt(e.getAttribute("width")||0),t.xPosition=function(e){return-1!==["left","right"].indexOf(e)?e:parseInt(e||0)}(e.getAttribute("xPosition")),t.yPosition=function(e){return-1!==["top","bottom"].indexOf(e)?e:parseInt(e||0)}(e.getAttribute("yPosition")),t.apiFramework=e.getAttribute("apiFramework"),t.pxratio=e.getAttribute("pxratio")||"1",t.offset=R.parseDuration(e.getAttribute("offset")),t.duration=R.parseDuration(e.getAttribute("duration")),R.childrenByName(e,"HTMLResource").forEach((function(e){t.type=e.getAttribute("creativeType")||"text/html",t.htmlResource=R.parseNodeText(e)})),R.childrenByName(e,"IFrameResource").forEach((function(e){t.type=e.getAttribute("creativeType")||0,t.iframeResource=R.parseNodeText(e)})),R.childrenByName(e,"StaticResource").forEach((function(e){t.type=e.getAttribute("creativeType")||0,t.staticResource=R.parseNodeText(e)}));var i=R.childByName(e,"IconClicks");return i&&(t.iconClickThroughURLTemplate=R.parseNodeText(R.childByName(i,"IconClickThrough")),R.childrenByName(i,"IconClickTracking").forEach((function(e){t.iconClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:R.parseNodeText(e)})}))),t.iconViewTrackingURLTemplate=R.parseNodeText(R.childByName(e,"IconViewTracking")),t}(e))})),n}function M(e,t){var i=function(){var e=v(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return{id:e.id,adId:e.adId,sequence:e.sequence,apiFramework:e.apiFramework,type:"nonlinear",variations:[],trackingEvents:{}}}(t);return R.childrenByName(e,"TrackingEvents").forEach((function(e){var t,n;R.childrenByName(e,"Tracking").forEach((function(e){t=e.getAttribute("event"),n=R.parseNodeText(e),t&&n&&(Array.isArray(i.trackingEvents[t])||(i.trackingEvents[t]=[]),i.trackingEvents[t].push(n))}))})),R.childrenByName(e,"NonLinear").forEach((function(e){var t={id:null,width:0,height:0,expandedWidth:0,expandedHeight:0,scalable:!0,maintainAspectRatio:!0,minSuggestedDuration:0,apiFramework:"static",adType:"nonLinearAd",type:null,staticResource:null,htmlResource:null,iframeResource:null,nonlinearClickThroughURLTemplate:null,nonlinearClickTrackingURLTemplates:[],adParameters:null};t.id=e.getAttribute("id")||null,t.width=e.getAttribute("width"),t.height=e.getAttribute("height"),t.expandedWidth=e.getAttribute("expandedWidth"),t.expandedHeight=e.getAttribute("expandedHeight"),t.scalable=R.parseBoolean(e.getAttribute("scalable")),t.maintainAspectRatio=R.parseBoolean(e.getAttribute("maintainAspectRatio")),t.minSuggestedDuration=R.parseDuration(e.getAttribute("minSuggestedDuration")),t.apiFramework=e.getAttribute("apiFramework"),R.childrenByName(e,"HTMLResource").forEach((function(e){t.type=e.getAttribute("creativeType")||"text/html",t.htmlResource=R.parseNodeText(e)})),R.childrenByName(e,"IFrameResource").forEach((function(e){t.type=e.getAttribute("creativeType")||0,t.iframeResource=R.parseNodeText(e)})),R.childrenByName(e,"StaticResource").forEach((function(e){t.type=e.getAttribute("creativeType")||0,t.staticResource=R.parseNodeText(e)}));var n=R.childByName(e,"AdParameters");n&&(t.adParameters=R.parseNodeText(n)),t.nonlinearClickThroughURLTemplate=R.parseNodeText(R.childByName(e,"NonLinearClickThrough")),R.childrenByName(e,"NonLinearClickTracking").forEach((function(e){t.nonlinearClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:R.parseNodeText(e)})})),i.variations.push(t)})),i}function D(e){var t=[];return e.forEach((function(e){var i=w(e);i&&t.push(i)})),t}function w(e){if("#comment"===e.nodeName)return null;var t,i={name:null,value:null,attributes:{},children:[]},n=e.attributes,r=e.childNodes;if(i.name=e.nodeName,e.attributes)for(var a in n)if(n.hasOwnProperty(a)){var s=n[a];s.nodeName&&s.nodeValue&&(i.attributes[s.nodeName]=s.nodeValue)}for(var o in r)if(r.hasOwnProperty(o)){var d=w(r[o]);d&&i.children.push(d)}if(0===i.children.length||1===i.children.length&&["#cdata-section","#text"].indexOf(i.children[0].name)>=0){var l=R.parseNodeText(e);""!==l&&(i.value=l),i.children=[]}return null===(t=i).value&&0===Object.keys(t.attributes).length&&0===t.children.length?null:i}function P(e){var t=[];return e.forEach((function(e){var i,n={id:e.getAttribute("id")||null,adId:O(e),sequence:e.getAttribute("sequence")||null,apiFramework:e.getAttribute("apiFramework")||null},r=[];R.childrenByName(e,"UniversalAdId").forEach((function(e){var t={idRegistry:e.getAttribute("idRegistry")||"unknown",value:R.parseNodeText(e)};r.push(t)}));var a=R.childByName(e,"CreativeExtensions");for(var s in a&&(i=D(R.childrenByName(a,"CreativeExtension"))),e.childNodes){var o=e.childNodes[s],d=void 0;switch(o.nodeName){case"Linear":d=I(o,n);break;case"NonLinearAds":d=M(o,n);break;case"CompanionAds":d=L(o,n)}d&&(r&&(d.universalAdIds=r),i&&(d.creativeExtensions=i),t.push(d))}})),t}function O(e){return e.getAttribute("AdID")||e.getAttribute("adID")||e.getAttribute("adId")||null}var U={Wrapper:{subElements:["VASTAdTagURI","Impression"]},BlockedAdCategories:{attributes:["authority"]},InLine:{subElements:["AdSystem","AdTitle","Impression","AdServingId","Creatives"]},Category:{attributes:["authority"]},Pricing:{attributes:["model","currency"]},Verification:{oneOfinLineResources:["JavaScriptResource","ExecutableResource"],attributes:["vendor"]},UniversalAdId:{attributes:["idRegistry"]},JavaScriptResource:{attributes:["apiFramework","browserOptional"]},ExecutableResource:{attributes:["apiFramework","type"]},Tracking:{attributes:["event"]},Creatives:{subElements:["Creative"]},Creative:{subElements:["UniversalAdId"]},Linear:{subElements:["MediaFiles","Duration"]},MediaFiles:{subElements:["MediaFile"]},MediaFile:{attributes:["delivery","type","width","height"]},Mezzanine:{attributes:["delivery","type","width","height"]},NonLinear:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"],attributes:["width","height"]},Companion:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"],attributes:["width","height"]},StaticResource:{attributes:["creativeType"]},Icons:{subElements:["Icon"]},Icon:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"]}};function x(e,t){if(U[e.nodeName]&&U[e.nodeName].attributes){var i=U[e.nodeName].attributes.filter((function(t){return!e.getAttribute(t)}));i.length>0&&B({name:e.nodeName,parentName:e.parentNode.nodeName,attributes:i},t)}}function F(e,t,i){var n=U[e.nodeName],r=!i&&"Wrapper"!==e.nodeName;if(n&&!r){if(n.subElements){var a=n.subElements.filter((function(t){return!R.childByName(e,t)}));a.length>0&&B({name:e.nodeName,parentName:e.parentNode.nodeName,subElements:a},t)}i&&n.oneOfinLineResources&&(n.oneOfinLineResources.some((function(t){return R.childByName(e,t)}))||B({name:e.nodeName,parentName:e.parentNode.nodeName,oneOfResources:n.oneOfinLineResources},t))}}function W(e){return e.children&&0!==e.children.length}function B(e,t){var i=e.name,n=e.parentName,r=e.attributes,a=e.subElements,s=e.oneOfResources,o="Element '".concat(i,"'");t("VAST-warning",{message:o+=r?" missing required attribute(s) '".concat(r.join(", "),"' "):a?" missing required sub element(s) '".concat(a.join(", "),"' "):s?" must provide one of the following '".concat(s.join(", "),"' "):" is empty",parentElement:n,specVersion:4.1})}var Q=function e(t,i,n){if(t&&t.nodeName)if("InLine"===t.nodeName&&(n=!0),x(t,i),W(t)){F(t,i,n);for(var r=0;r<t.children.length;r++)e(t.children[r],i,n)}else 0===R.parseNodeText(t).length&&B({name:t.nodeName,parentName:t.parentNode.nodeName},i)};function j(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i.allowMultipleAds,r=i.followAdditionalWrappers,a=e.childNodes;for(var s in a){var o=a[s];if(-1!==["Wrapper","InLine"].indexOf(o.nodeName)&&("Wrapper"!==o.nodeName||!1!==r)){if(R.copyNodeAttribute("id",e,o),R.copyNodeAttribute("sequence",e,o),R.copyNodeAttribute("adType",e,o),"Wrapper"===o.nodeName)return{ad:H(o,t),type:"WRAPPER"};if("InLine"===o.nodeName)return{ad:q(o,t,{allowMultipleAds:n}),type:"INLINE"}}}}function q(e,t){return!1===(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).allowMultipleAds&&e.getAttribute("sequence")?null:z(e,t)}function z(e,t){var i=[];t&&Q(e,t);var n=e.childNodes,r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,sequence:e.sequence||null,adType:e.adType||null,adServingId:null,categories:[],expires:null,viewableImpression:[],system:null,title:null,description:null,advertiser:null,pricing:null,survey:null,errorURLTemplates:[],impressionURLTemplates:[],creatives:[],extensions:[],adVerifications:[],blockedAdCategories:[],followAdditionalWrappers:!0,allowMultipleAds:!1,fallbackOnNoAd:null}}(R.parseAttributes(e));for(var a in n){var s=n[a];switch(s.nodeName){case"Error":r.errorURLTemplates.push(R.parseNodeText(s));break;case"Impression":r.impressionURLTemplates.push({id:s.getAttribute("id")||null,url:R.parseNodeText(s)});break;case"Creatives":r.creatives=P(R.childrenByName(s,"Creative"));break;case"Extensions":var o=R.childrenByName(s,"Extension");r.extensions=D(o),r.adVerifications.length||(i=Y(o));break;case"AdVerifications":r.adVerifications=G(R.childrenByName(s,"Verification"));break;case"AdSystem":r.system={value:R.parseNodeText(s),version:s.getAttribute("version")||null};break;case"AdTitle":r.title=R.parseNodeText(s);break;case"AdServingId":r.adServingId=R.parseNodeText(s);break;case"Category":r.categories.push({authority:s.getAttribute("authority")||null,value:R.parseNodeText(s)});break;case"Expires":r.expires=parseInt(R.parseNodeText(s),10);break;case"ViewableImpression":r.viewableImpression.push(K(s));break;case"Description":r.description=R.parseNodeText(s);break;case"Advertiser":r.advertiser={id:s.getAttribute("id")||null,value:R.parseNodeText(s)};break;case"Pricing":r.pricing={value:R.parseNodeText(s),model:s.getAttribute("model")||null,currency:s.getAttribute("currency")||null};break;case"Survey":r.survey=R.parseNodeText(s);break;case"BlockedAdCategories":r.blockedAdCategories.push({authority:s.getAttribute("authority")||null,value:R.parseNodeText(s)})}}return i.length&&(r.adVerifications=r.adVerifications.concat(i)),r}function H(e,t){var i=z(e,t),n=e.getAttribute("followAdditionalWrappers"),r=e.getAttribute("allowMultipleAds"),a=e.getAttribute("fallbackOnNoAd");i.followAdditionalWrappers=!n||R.parseBoolean(n),i.allowMultipleAds=!!r&&R.parseBoolean(r),i.fallbackOnNoAd=a?R.parseBoolean(a):null;var s=R.childByName(e,"VASTAdTagURI");if(s?i.nextWrapperURL=R.parseNodeText(s):(s=R.childByName(e,"VASTAdTagURL"))&&(i.nextWrapperURL=R.parseNodeText(R.childByName(s,"URL"))),i.creatives.forEach((function(e){if(-1!==["linear","nonlinear"].indexOf(e.type)){if(e.trackingEvents){i.trackingEvents||(i.trackingEvents={}),i.trackingEvents[e.type]||(i.trackingEvents[e.type]={});var t=function(t){var n=e.trackingEvents[t];Array.isArray(i.trackingEvents[e.type][t])||(i.trackingEvents[e.type][t]=[]),n.forEach((function(n){i.trackingEvents[e.type][t].push(n)}))};for(var n in e.trackingEvents)t(n)}e.videoClickTrackingURLTemplates&&(Array.isArray(i.videoClickTrackingURLTemplates)||(i.videoClickTrackingURLTemplates=[]),e.videoClickTrackingURLTemplates.forEach((function(e){i.videoClickTrackingURLTemplates.push(e)}))),e.videoClickThroughURLTemplate&&(i.videoClickThroughURLTemplate=e.videoClickThroughURLTemplate),e.videoCustomClickURLTemplates&&(Array.isArray(i.videoCustomClickURLTemplates)||(i.videoCustomClickURLTemplates=[]),e.videoCustomClickURLTemplates.forEach((function(e){i.videoCustomClickURLTemplates.push(e)})))}})),i.nextWrapperURL)return i}function G(e){var t=[];return e.forEach((function(e){var i={resource:null,vendor:null,browserOptional:!1,apiFramework:null,type:null,parameters:null,trackingEvents:{}},n=e.childNodes;for(var r in R.assignAttributes(e.attributes,i),n){var a=n[r];switch(a.nodeName){case"JavaScriptResource":case"ExecutableResource":i.resource=R.parseNodeText(a),R.assignAttributes(a.attributes,i);break;case"VerificationParameters":i.parameters=R.parseNodeText(a)}}var s=R.childByName(e,"TrackingEvents");s&&R.childrenByName(s,"Tracking").forEach((function(e){var t=e.getAttribute("event"),n=R.parseNodeText(e);t&&n&&(Array.isArray(i.trackingEvents[t])||(i.trackingEvents[t]=[]),i.trackingEvents[t].push(n))})),t.push(i)})),t}function Y(e){var t=null,i=[];return e.some((function(e){return t=R.childByName(e,"AdVerifications")})),t&&(i=G(R.childrenByName(t,"Verification"))),i}function K(e){var t={};t.id=e.getAttribute("id")||null;var i=e.childNodes;for(var n in i){var r=i[n],a=r.nodeName,s=R.parseNodeText(r);if(("Viewable"===a||"NotViewable"===a||"ViewUndetermined"===a)&&s){var o=a.toLowerCase();Array.isArray(t[o])||(t[o]=[]),t[o].push(s)}}return t}var X=function(){function e(){r(this,e),this._handlers=[]}return s(e,[{key:"on",value:function(e,t){if("function"!=typeof t)throw new TypeError("The handler argument must be of type Function. Received type ".concat(n(t)));if(!e)throw new TypeError("The event argument must be of type String. Received type ".concat(n(e)));return this._handlers.push({event:e,handler:t}),this}},{key:"once",value:function(e,t){return this.on(e,function(e,t,i){var n={fired:!1,wrapFn:void 0};function r(){n.fired||(e.off(t,n.wrapFn),n.fired=!0,i.bind(e).apply(void 0,arguments))}return n.wrapFn=r,r}(this,e,t))}},{key:"off",value:function(e,t){return this._handlers=this._handlers.filter((function(i){return i.event!==e||i.handler!==t})),this}},{key:"emit",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var r=!1;return this._handlers.forEach((function(t){"*"===t.event&&(r=!0,t.handler.apply(t,[e].concat(i))),t.event===e&&(r=!0,t.handler.apply(t,i))})),r}},{key:"removeAllListeners",value:function(e){return e?(this._handlers=this._handlers.filter((function(t){return t.event!==e})),this):(this._handlers=[],this)}},{key:"listenerCount",value:function(e){return this._handlers.filter((function(t){return t.event===e})).length}},{key:"listeners",value:function(e){return this._handlers.reduce((function(t,i){return i.event===e&&t.push(i.handler),t}),[])}},{key:"eventNames",value:function(){return this._handlers.map((function(e){return e.event}))}}]),e}(),J=function(e,t,i){i(new Error("Please bundle the library for node to use the node urlHandler"))},$=12e4;function Z(){try{var e=new window.XMLHttpRequest;return"withCredentials"in e?e:null}catch(e){return null}}function ee(e,t,i){var n=i?408:e.status,r=i?"XHRURLHandler: Request timed out after ".concat(e.timeout," ms (").concat(n,")"):"XHRURLHandler: ".concat(e.statusText," (").concat(n,")");t(new Error(r),null,{statusCode:n})}var te=function(e,t,i){if("https:"===window.location.protocol&&0===e.indexOf("http://"))return i(new Error("XHRURLHandler: Cannot go from HTTPS to HTTP."));try{var n=Z();n.open("GET",e),n.timeout=t.timeout||$,n.withCredentials=t.withCredentials||!1,n.overrideMimeType&&n.overrideMimeType("text/xml"),n.onload=function(){return function(e,t){200===e.status?t(null,e.responseXML,{byteLength:e.response.length,statusCode:e.status}):ee(e,t,!1)}(n,i)},n.onerror=function(){return ee(n,i,!1)},n.onabort=function(){return ee(n,i,!1)},n.ontimeout=function(){return ee(n,i,!0)},n.send()}catch(e){i(new Error("XHRURLHandler: Unexpected error"))}},ie=function(){return!!Z()},ne={get:function(e,t,i){return i||("function"==typeof t&&(i=t),t={}),"undefined"==typeof window||null===window?J(e,t,i):ie()?te(e,t,i):i(new Error("Current context is not supported by any of the default URLHandlers. Please provide a custom URLHandler"))}},re=0,ae=0,se=function(e,t){!e||!t||e<=0||t<=0||(ae=(ae*re+8*e/t)/++re)},oe={ERRORCODE:900,extensions:[]},de=function(e){d(i,e);var t=c(i);function i(){var e;return r(this,i),(e=t.call(this)).remainingAds=[],e.parentURLs=[],e.errorURLTemplates=[],e.rootErrorURLTemplates=[],e.maxWrapperDepth=null,e.URLTemplateFilters=[],e.fetchingOptions={},e.parsingOptions={},e}return s(i,[{key:"addURLTemplateFilter",value:function(e){"function"==typeof e&&this.URLTemplateFilters.push(e)}},{key:"removeURLTemplateFilter",value:function(){this.URLTemplateFilters.pop()}},{key:"countURLTemplateFilters",value:function(){return this.URLTemplateFilters.length}},{key:"clearURLTemplateFilters",value:function(){this.URLTemplateFilters=[]}},{key:"trackVastError",value:function(e,t){for(var i=arguments.length,n=new Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];this.emit("VAST-error",Object.assign.apply(Object,[{},oe,t].concat(n))),V.track(e,t)}},{key:"getErrorURLTemplates",value:function(){return this.rootErrorURLTemplates.concat(this.errorURLTemplates)}},{key:"getEstimatedBitrate",value:function(){return ae}},{key:"fetchVAST",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Promise((function(a,s){t.URLTemplateFilters.forEach((function(t){e=t(e)})),t.parentURLs.push(e);var o=Date.now();t.emit("VAST-resolving",{url:e,previousUrl:n,wrapperDepth:i,maxWrapperDepth:t.maxWrapperDepth,timeout:t.fetchingOptions.timeout,wrapperAd:r}),t.urlHandler.get(e,t.fetchingOptions,(function(r,d){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},h=Math.round(Date.now()-o),u=Object.assign({url:e,previousUrl:n,wrapperDepth:i,error:r,duration:h},l);t.emit("VAST-resolved",u),se(l.byteLength,h),r?s(r):a(d)}))}))}},{key:"initParsingStatus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.errorURLTemplates=[],this.fetchingOptions={timeout:e.timeout||$,withCredentials:e.withCredentials},this.maxWrapperDepth=e.wrapperLimit||10,this.parentURLs=[],this.parsingOptions={allowMultipleAds:e.allowMultipleAds},this.remainingAds=[],this.rootErrorURLTemplates=[],this.rootURL="",this.urlHandler=e.urlHandler||e.urlhandler||ne,this.vastVersion=null,se(e.byteLength,e.requestDuration)}},{key:"getRemainingAds",value:function(e){var t=this;if(0===this.remainingAds.length)return Promise.reject(new Error("No more ads are available for the given VAST"));var i=e?V.flatten(this.remainingAds):this.remainingAds.shift();return this.errorURLTemplates=[],this.parentURLs=[],this.resolveAds(i,{wrapperDepth:0,url:this.rootURL}).then((function(e){return t.buildVASTResponse(e)}))}},{key:"getAndParseVAST",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.initParsingStatus(i),this.URLTemplateFilters.forEach((function(t){e=t(e)})),this.rootURL=e,this.fetchVAST(e).then((function(n){return i.previousUrl=e,i.isRootVAST=!0,i.url=e,t.parse(n,i).then((function(e){return t.buildVASTResponse(e)}))}))}},{key:"parseVAST",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.initParsingStatus(i),i.isRootVAST=!0,this.parse(e,i).then((function(e){return t.buildVASTResponse(e)}))}},{key:"buildVASTResponse",value:function(e){var t,i={ads:(t={ads:e,errorURLTemplates:this.getErrorURLTemplates(),version:this.vastVersion}).ads||[],errorURLTemplates:t.errorURLTemplates||[],version:t.version||null};return this.completeWrapperResolving(i),i}},{key:"parseVastXml",value:function(e,t){var i=t.isRootVAST,n=void 0!==i&&i,r=t.url,a=void 0===r?null:r,s=t.wrapperDepth,o=void 0===s?0:s,d=t.allowMultipleAds,l=t.followAdditionalWrappers;if(!e||!e.documentElement||"VAST"!==e.documentElement.nodeName)throw this.emit("VAST-ad-parsed",{type:"ERROR",url:a,wrapperDepth:o}),new Error("Invalid VAST XMLDocument");var h=[],u=e.documentElement.childNodes,c=e.documentElement.getAttribute("version");for(var p in n&&c&&(this.vastVersion=c),u){var A=u[p];if("Error"===A.nodeName){var v=R.parseNodeText(A);n?this.rootErrorURLTemplates.push(v):this.errorURLTemplates.push(v)}else if("Ad"===A.nodeName){if(this.vastVersion&&parseFloat(this.vastVersion)<3)d=!0;else if(!1===d&&h.length>1)break;var m=j(A,this.emit.bind(this),{allowMultipleAds:d,followAdditionalWrappers:l});m.ad?(h.push(m.ad),this.emit("VAST-ad-parsed",{type:m.type,url:a,wrapperDepth:o,adIndex:h.length-1,vastVersion:c})):this.trackVastError(this.getErrorURLTemplates(),{ERRORCODE:101})}}return h}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.url,n=void 0===i?null:i,r=t.resolveAll,a=void 0===r||r,s=t.wrapperSequence,o=void 0===s?null:s,d=t.previousUrl,l=void 0===d?null:d,h=t.wrapperDepth,u=void 0===h?0:h,c=t.isRootVAST,p=void 0!==c&&c,A=t.followAdditionalWrappers,v=t.allowMultipleAds,m=[];this.vastVersion&&parseFloat(this.vastVersion)<3&&p&&(v=!0);try{m=this.parseVastXml(e,{isRootVAST:p,url:n,wrapperDepth:u,allowMultipleAds:v,followAdditionalWrappers:A})}catch(e){return Promise.reject(e)}return 1===m.length&&null!=o&&(m[0].sequence=o),!1===a&&(this.remainingAds=R.splitVAST(m),m=this.remainingAds.shift()),this.resolveAds(m,{wrapperDepth:u,previousUrl:l,url:n})}},{key:"resolveAds",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1?arguments[1]:void 0,n=i.wrapperDepth,r=i.previousUrl,a=i.url,s=[];return r=a,t.forEach((function(t){var i=e.resolveWrappers(t,n,r);s.push(i)})),Promise.all(s).then((function(t){var i=V.flatten(t);if(!i&&e.remainingAds.length>0){var s=e.remainingAds.shift();return e.resolveAds(s,{wrapperDepth:n,previousUrl:r,url:a})}return i}))}},{key:"resolveWrappers",value:function(e,t,i){var n=this;return new Promise((function(r){var a;if(t++,!e.nextWrapperURL)return delete e.nextWrapperURL,r(e);if(t>=n.maxWrapperDepth||-1!==n.parentURLs.indexOf(e.nextWrapperURL))return e.errorCode=302,delete e.nextWrapperURL,r(e);e.nextWrapperURL=R.resolveVastAdTagURI(e.nextWrapperURL,i),n.URLTemplateFilters.forEach((function(t){e.nextWrapperURL=t(e.nextWrapperURL)}));var s=null!==(a=n.parsingOptions.allowMultipleAds)&&void 0!==a?a:e.allowMultipleAds,o=e.sequence;n.fetchVAST(e.nextWrapperURL,t,i,e).then((function(a){return n.parse(a,{url:e.nextWrapperURL,previousUrl:i,wrapperSequence:o,wrapperDepth:t,followAdditionalWrappers:e.followAdditionalWrappers,allowMultipleAds:s}).then((function(t){if(delete e.nextWrapperURL,0===t.length)return e.creatives=[],r(e);t.forEach((function(t){t&&R.mergeWrapperAdData(t,e)})),r(t)}))})).catch((function(t){e.errorCode=301,e.errorMessage=t.message,r(e)}))}))}},{key:"completeWrapperResolving",value:function(e){if(0===e.ads.length)this.trackVastError(e.errorURLTemplates,{ERRORCODE:303});else for(var t=e.ads.length-1;t>=0;t--){var i=e.ads[t];(i.errorCode||0===i.creatives.length)&&(this.trackVastError(i.errorURLTemplates.concat(e.errorURLTemplates),{ERRORCODE:i.errorCode||303},{ERRORMESSAGE:i.errorMessage||""},{extensions:i.extensions},{system:i.system}),e.ads.splice(t,1))}}}]),i}(X),le=null,he={data:{},length:0,getItem:function(e){return this.data[e]},setItem:function(e,t){this.data[e]=t,this.length=Object.keys(this.data).length},removeItem:function(e){delete this.data[e],this.length=Object.keys(this.data).length},clear:function(){this.data={},this.length=0}},ue=function(){function e(){r(this,e),this.storage=this.initStorage()}return s(e,[{key:"initStorage",value:function(){if(le)return le;try{le="undefined"!=typeof window&&null!==window?window.localStorage||window.sessionStorage:null}catch(e){le=null}return le&&!this.isStorageDisabled(le)||(le=he).clear(),le}},{key:"isStorageDisabled",value:function(e){var t="__VASTStorage__";try{if(e.setItem(t,t),e.getItem(t)!==t)return e.removeItem(t),!0}catch(e){return!0}return e.removeItem(t),!1}},{key:"getItem",value:function(e){return this.storage.getItem(e)}},{key:"setItem",value:function(e,t){return this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){return this.storage.removeItem(e)}},{key:"clear",value:function(){return this.storage.clear()}}]),e}(),ce=function(){function e(t,i,n){r(this,e),this.cappingFreeLunch=t||0,this.cappingMinimumTimeInterval=i||0,this.defaultOptions={withCredentials:!1,timeout:0},this.vastParser=new de,this.storage=n||new ue,void 0===this.lastSuccessfulAd&&(this.lastSuccessfulAd=0),void 0===this.totalCalls&&(this.totalCalls=0),void 0===this.totalCallsTimeout&&(this.totalCallsTimeout=0)}return s(e,[{key:"getParser",value:function(){return this.vastParser}},{key:"lastSuccessfulAd",get:function(){return this.storage.getItem("vast-client-last-successful-ad")},set:function(e){this.storage.setItem("vast-client-last-successful-ad",e)}},{key:"totalCalls",get:function(){return this.storage.getItem("vast-client-total-calls")},set:function(e){this.storage.setItem("vast-client-total-calls",e)}},{key:"totalCallsTimeout",get:function(){return this.storage.getItem("vast-client-total-calls-timeout")},set:function(e){this.storage.setItem("vast-client-total-calls-timeout",e)}},{key:"hasRemainingAds",value:function(){return this.vastParser.remainingAds.length>0}},{key:"getNextAds",value:function(e){return this.vastParser.getRemainingAds(e)}},{key:"get",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Date.now();return(i=Object.assign({},this.defaultOptions,i)).hasOwnProperty("resolveAll")||(i.resolveAll=!1),this.totalCallsTimeout<n?(this.totalCalls=1,this.totalCallsTimeout=n+36e5):this.totalCalls++,new Promise((function(r,a){if(t.cappingFreeLunch>=t.totalCalls)return a(new Error("VAST call canceled – FreeLunch capping not reached yet ".concat(t.totalCalls,"/").concat(t.cappingFreeLunch)));var s=n-t.lastSuccessfulAd;if(s<0)t.lastSuccessfulAd=0;else if(s<t.cappingMinimumTimeInterval)return a(new Error("VAST call canceled – (".concat(t.cappingMinimumTimeInterval,")ms minimum interval reached")));t.vastParser.getAndParseVAST(e,i).then((function(e){return r(e)})).catch((function(e){return a(e)}))}))}}]),e}(),pe=function(e){d(n,e);var t=c(n);function n(e,i,a){var s,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;for(var d in r(this,n),(s=t.call(this)).ad=i,s.creative=a,s.variation=o,s.muted=!1,s.impressed=!1,s.skippable=!1,s.trackingEvents={},s.lastPercentage=0,s._alreadyTriggeredQuartiles={},s.emitAlwaysEvents=["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","resume","pause","rewind","skip","closeLinear","close"],s.creative.trackingEvents){var l=s.creative.trackingEvents[d];s.trackingEvents[d]=l.slice(0)}return N(s.creative)?s._initLinearTracking():s._initVariationTracking(),e&&s.on("start",(function(){e.lastSuccessfulAd=Date.now()})),s}return s(n,[{key:"_initLinearTracking",value:function(){this.linear=!0,this.skipDelay=this.creative.skipDelay,this.setDuration(this.creative.duration),this.clickThroughURLTemplate=this.creative.videoClickThroughURLTemplate,this.clickTrackingURLTemplates=this.creative.videoClickTrackingURLTemplates}},{key:"_initVariationTracking",value:function(){if(this.linear=!1,this.skipDelay=-1,this.variation){for(var e in this.variation.trackingEvents){var t=this.variation.trackingEvents[e];this.trackingEvents[e]?this.trackingEvents[e]=this.trackingEvents[e].concat(t.slice(0)):this.trackingEvents[e]=t.slice(0)}"nonLinearAd"===this.variation.adType?(this.clickThroughURLTemplate=this.variation.nonlinearClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.nonlinearClickTrackingURLTemplates,this.setDuration(this.variation.minSuggestedDuration)):function(e){return"companionAd"===e.adType}(this.variation)&&(this.clickThroughURLTemplate=this.variation.companionClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.companionClickTrackingURLTemplates)}}},{key:"setDuration",value:function(e){this.assetDuration=e,this.quartiles={firstQuartile:Math.round(25*this.assetDuration)/100,midpoint:Math.round(50*this.assetDuration)/100,thirdQuartile:Math.round(75*this.assetDuration)/100}}},{key:"setProgress",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.skipDelay||-1;if(-1===n||this.skippable||(n>e?this.emit("skip-countdown",n-e):(this.skippable=!0,this.emit("skip-countdown",0))),this.assetDuration>0){var r=Math.round(e/this.assetDuration*100),a=[];if(e>0){a.push("start");for(var s=this.lastPercentage;s<r;s++)a.push("progress-".concat(s+1,"%"));for(var o in a.push("progress-".concat(Math.round(e))),this.quartiles)this.isQuartileReached(o,this.quartiles[o],e)&&(a.push(o),this._alreadyTriggeredQuartiles[o]=!0);this.lastPercentage=r}a.forEach((function(e){t.track(e,{macros:i,once:!0})})),e<this.progress&&this.track("rewind",{macros:i})}this.progress=e}},{key:"isQuartileReached",value:function(e,t,i){var n=!1;return t<=i&&!this._alreadyTriggeredQuartiles[e]&&(n=!0),n}},{key:"setMuted",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.muted!==e&&this.track(e?"mute":"unmute",{macros:t}),this.muted=e}},{key:"setPaused",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.paused!==e&&this.track(e?"pause":"resume",{macros:t}),this.paused=e}},{key:"setFullscreen",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fullscreen!==e&&this.track(e?"fullscreen":"exitFullscreen",{macros:t}),this.fullscreen=e}},{key:"setExpand",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.expanded!==e&&(this.track(e?"expand":"collapse",{macros:t}),this.track(e?"playerExpand":"playerCollapse",{macros:t})),this.expanded=e}},{key:"setSkipDelay",value:function(e){"number"==typeof e&&(this.skipDelay=e)}},{key:"trackImpression",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.impressed||(this.impressed=!0,this.trackURLs(this.ad.impressionURLTemplates,e),this.track("creativeView",{macros:e}))}},{key:"error",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.trackURLs(this.ad.errorURLTemplates,e,{isCustomCode:t})}},{key:"errorWithCode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.error({ERRORCODE:e},t)}},{key:"complete",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track("complete",{macros:e})}},{key:"notUsed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track("notUsed",{macros:e}),this.trackingEvents=[]}},{key:"otherAdInteraction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track("otherAdInteraction",{macros:e})}},{key:"acceptInvitation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track("acceptInvitation",{macros:e})}},{key:"adExpand",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track("adExpand",{macros:e})}},{key:"adCollapse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track("adCollapse",{macros:e})}},{key:"minimize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track("minimize",{macros:e})}},{key:"verificationNotExecuted",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.ad||!this.ad.adVerifications||!this.ad.adVerifications.length)throw new Error("No adVerifications provided");if(!e)throw new Error("No vendor provided, unable to find associated verificationNotExecuted");var i=this.ad.adVerifications.find((function(t){return t.vendor===e}));if(!i)throw new Error("No associated verification element found for vendor: ".concat(e));var n=i.trackingEvents;if(n&&n.verificationNotExecuted){var r=n.verificationNotExecuted;this.trackURLs(r,t),this.emit("verificationNotExecuted",{trackingURLTemplates:r})}}},{key:"overlayViewDuration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.ADPLAYHEAD=e,this.track("overlayViewDuration",{macros:t})}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track(this.linear?"closeLinear":"close",{macros:e})}},{key:"skip",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track("skip",{macros:e})}},{key:"load",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.track("loaded",{macros:e})}},{key:"click",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.clickTrackingURLTemplates&&this.clickTrackingURLTemplates.length&&this.trackURLs(this.clickTrackingURLTemplates,t);var n=this.clickThroughURLTemplate||e,r=i({},t);if(n){this.progress&&(r.ADPLAYHEAD=this.progressFormatted());var a=V.resolveURLTemplates([n],r)[0];this.emit("clickthrough",a)}}},{key:"track",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.macros,n=void 0===i?{}:i,r=t.once,a=void 0!==r&&r;"closeLinear"===e&&!this.trackingEvents[e]&&this.trackingEvents.close&&(e="close");var s=this.trackingEvents[e],o=this.emitAlwaysEvents.indexOf(e)>-1;s?(this.emit(e,{trackingURLTemplates:s}),this.trackURLs(s,n)):o&&this.emit(e,null),a&&(delete this.trackingEvents[e],o&&this.emitAlwaysEvents.splice(this.emitAlwaysEvents.indexOf(e),1))}},{key:"trackURLs",value:function(e){var t,n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});this.linear&&(this.creative&&this.creative.mediaFiles&&this.creative.mediaFiles[0]&&this.creative.mediaFiles[0].fileURL&&(a.ASSETURI=this.creative.mediaFiles[0].fileURL),this.progress&&(a.ADPLAYHEAD=this.progressFormatted())),null!==(t=this.creative)&&void 0!==t&&null!==(n=t.universalAdIds)&&void 0!==n&&n.length&&(a.UNIVERSALADID=this.creative.universalAdIds.map((function(e){return e.idRegistry.concat(" ",e.value)})).join(",")),this.ad&&(this.ad.sequence&&(a.PODSEQUENCE=this.ad.sequence),this.ad.adType&&(a.ADTYPE=this.ad.adType),this.ad.adServingId&&(a.ADSERVINGID=this.ad.adServingId),this.ad.categories&&this.ad.categories.length&&(a.ADCATEGORIES=this.ad.categories.map((function(e){return e.value})).join(",")),this.ad.blockedAdCategories&&this.ad.blockedAdCategories.length&&(a.BLOCKEDADCATEGORIES=this.ad.blockedAdCategories)),V.track(e,a,r)}},{key:"convertToTimecode",value:function(e){var t=1e3*e,i=Math.floor(t/36e5),n=Math.floor(t/6e4%60),r=Math.floor(t/1e3%60),a=Math.floor(t%1e3);return"".concat(V.leftpad(i,2),":").concat(V.leftpad(n,2),":").concat(V.leftpad(r,2),".").concat(V.leftpad(a,3))}},{key:"progressFormatted",value:function(){return this.convertToTimecode(this.progress)}}]),n}(X);e.VASTClient=ce,e.VASTParser=de,e.VASTTracker=pe,Object.defineProperty(e,"__esModule",{value:!0})}(t)}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var i=a[e]={exports:{}};return r[e].call(i.exports,i,i.exports,s),i.exports}s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o={};(()=>{s.d(o,{h:()=>n});var e=s(686);const t=function(e,t,i){this.message=e,this.errorCode=t,this.innerError=i};t.prototype.getMessage=function(){return this.message},t.prototype.getErrorCode=function(){return this.errorCode},t.prototype.getInnerError=function(){return this.innerError instanceof Object?this.innerError:null},t.prototype.formatMessage=function(...e){return this.message=function(e,...t){try{t.forEach(((t,i)=>{e=e.replace(new RegExp("\\{"+i+"}","g"),t)}))}catch(e){}return e}(this.message,e),this},t.prototype.toString=function(){return"AdError "+this.getErrorCode()+": "+this.getMessage()+(null!=this.getInnerError()?" Caused by: "+this.getInnerError():"")};const i=t,n=function(e){if(!(e instanceof Element||e instanceof HTMLDocument))throw new Error("ad container is not defined");this._adContainer=e,this._slot=null,this._videoSlot=null,this.createSlot(),this.EVENTS={AdsManagerLoaded:"AdsManagerLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdLoaded:"AdLoaded",AdLinearChange:"AdLinearChange",AdSizeChange:"AdSizeChange",AdExpandedChange:"AdExpandedChange",AdSkippableStateChange:"AdSkippableStateChange",AdDurationChange:"AdDurationChange",AdRemainingTimeChange:"AdRemainingTimeChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdError:"AdError",AdLog:"AdLog",AllAdsCompleted:"AllAdsCompleted"},this._eventCallbacks={},this._creativeEventCallbacks={},this._attributes={width:300,height:154,viewMode:"normal",desiredBitrate:-1,duration:10,remainingTime:10,currentTime:0,volume:0,version:"1.1.9"},this._quartileEvents=[{event:"AdImpression",value:0},{event:"AdVideoStart",value:0},{event:"AdVideoFirstQuartile",value:25},{event:"AdVideoMidpoint",value:50},{event:"AdVideoThirdQuartile",value:75},{event:"AdVideoComplete",value:100}],this._nextQuartileIndex=0,this._defaultEventCallbacks={AdImpression:this.onAdImpression.bind(this),AdVideoStart:this.onAdVideoStart.bind(this),AdVideoFirstQuartile:this.onAdVideoFirstQuartile.bind(this),AdVideoMidpoint:this.onAdVideoMidpoint.bind(this),AdVideoThirdQuartile:this.onAdVideoThirdQuartile.bind(this),AdVideoComplete:this.onAdVideoComplete.bind(this)},this._options={autoplay:!0,muted:!0,vastLoadTimeout:23e3,loadVideoTimeout:8e3,withCredentials:!1,wrapperLimit:10,resolveAll:!0},this.ERROR_CODES={VAST_MALFORMED_RESPONSE:100,ADS_REQUEST_NETWORK_ERROR:1012,FAILED_TO_REQUEST_ADS:1005,UNKNOWN_AD_RESPONSE:1010,VAST_ASSET_NOT_FOUND:1007,VAST_EMPTY_RESPONSE:1009,VAST_LINEAR_ASSET_MISMATCH:403,VAST_LOAD_TIMEOUT:301,VAST_MEDIA_LOAD_TIMEOUT:402,VIDEO_PLAY_ERROR:400,VPAID_ERROR:901},this.ERROR_MESSAGES={VAST_MALFORMED_RESPONSE:"VAST response was malformed and could not be parsed.",ADS_REQUEST_ERROR:"Unable to request ads from server. Cause: {0}.",ADS_REQUEST_NETWORK_ERROR:"Unable to request ads from server due to network error.",FAILED_TO_REQUEST_ADS:"The was a problem requesting ads from the server.",NO_ADS_FOUND:"The response does not contain any valid ads.",UNKNOWN_AD_RESPONSE:"The ad response was not understood and cannot be parsed.",VAST_ASSET_NOT_FOUND:"No assets were found in the VAST ad response.",VAST_EMPTY_RESPONSE:"The VAST response document is empty.",VAST_LINEAR_ASSET_MISMATCH:"Linear assets were found in the VAST ad response, but none of them matched the player's capabilities.",VAST_LOAD_TIMEOUT:"Ad request reached a timeout.",VAST_MEDIA_LOAD_TIMEOUT:"VAST media file loading reached a timeout of {0} seconds.",VIDEO_PLAY_ERROR:"There was an error playing the video ad.",VPAID_CREATIVE_ERROR:"An unexpected error occurred within the VPAID creative. Refer to the inner error for more info."},this.ERRORS={VAST_MALFORMED_RESPONSE:new i(this.ERROR_MESSAGES.VAST_MALFORMED_RESPONSE,this.ERROR_CODES.VAST_MALFORMED_RESPONSE),VAST_EMPTY_RESPONSE:new i(this.ERROR_MESSAGES.VAST_EMPTY_RESPONSE,this.ERROR_CODES.VAST_EMPTY_RESPONSE),VAST_ASSET_NOT_FOUND:new i(this.ERROR_MESSAGES.VAST_ASSET_NOT_FOUND,this.ERROR_CODES.VAST_ASSET_NOT_FOUND),VAST_LINEAR_ASSET_MISMATCH:new i(this.ERROR_MESSAGES.VAST_LINEAR_ASSET_MISMATCH,this.ERROR_CODES.VAST_LINEAR_ASSET_MISMATCH),VAST_LOAD_TIMEOUT:new i(this.ERROR_MESSAGES.VAST_LOAD_TIMEOUT,this.ERROR_CODES.VAST_LOAD_TIMEOUT),VAST_MEDIA_LOAD_TIMEOUT:new i(this.ERROR_MESSAGES.VAST_MEDIA_LOAD_TIMEOUT,this.ERROR_CODES.VAST_MEDIA_LOAD_TIMEOUT),VIDEO_PLAY_ERROR:new i(this.ERROR_MESSAGES.VIDEO_PLAY_ERROR,this.ERROR_CODES.VIDEO_PLAY_ERROR)},this._vastClient=null,this._vastParser=null,this._vastTracker=null,this._ad=null,this._adPod=null,this._creative=null,this._mediaFiles=null,this._mediaFileIndex=0,this._mediaFile=null,this._isVPAID=!1,this._vpaidIframe=null,this._vpaidCreative=null,this._vastMediaLoadTimer=null,this._vpaidProgressTimer=null,this._requestId=null,this._handleLoadCreativeMessage=this.handleLoadCreativeMessage.bind(this),this._handleSlotClick=this.handleSlotClick.bind(this),this._handleVideoSlotError=this.handleVideoSlotError.bind(this),this._handleVideoSlotCanPlay=this.handleVideoSlotCanPlay.bind(this),this._handleVideoSlotVolumeChange=this.handleVideoSlotVolumeChange.bind(this),this._handleVideoSlotTimeUpdate=this.handleVideoSlotTimeUpdate.bind(this),this._handleVideoSlotLoadedMetaData=this.handleVideoSlotLoadedMetaData.bind(this),this._handleVideoSlotEnded=this.handleVideoSlotEnded.bind(this),this.SUPPORTED_CREATIVE_VPAID_VERSION_MIN=2,this._hasLoaded=!1,this._hasError=!1,this._hasImpression=!1,this._hasStarted=!1,this._isDestroyed=!1};n.prototype.createSlot=function(){this._slot=document.createElement("div"),this._slot.style.position="absolute",this._slot.style.display="none",this._adContainer.appendChild(this._slot),this.createVideoSlot()},n.prototype.removeSlot=function(){this._slot.parentNode&&this._slot.parentNode.removeChild(this._slot)},n.prototype.showSlot=function(){""===this._videoSlot.src&&this.hideVideoSlot(),this._slot.style.display="block"},n.prototype.hideSlot=function(){this._slot.style.display="none"},n.prototype.resizeSlot=function(e,t){this._slot.style.width=e+"px",this._slot.style.height=t+"px"},n.prototype.createVideoSlot=function(){this._videoSlot=document.createElement("video"),this._videoSlot.setAttribute("webkit-playsinline",!0),this._videoSlot.setAttribute("playsinline",!0),this._videoSlot.style.width="100%",this._videoSlot.style.height="100%",this._videoSlot.style.backgroundColor="rgb(0, 0, 0)",this._slot.appendChild(this._videoSlot)},n.prototype.hideVideoSlot=function(){this._videoSlot.style.display="none"},n.prototype.stopVASTMediaLoadTimeout=function(){this._vastMediaLoadTimer&&(clearTimeout(this._vastMediaLoadTimer),this._vastMediaLoadTimer=null)},n.prototype.startVASTMediaLoadTimeout=function(){this.stopVASTMediaLoadTimeout(),this._vastMediaLoadTimer=setTimeout((()=>{this.onAdError(this.ERRORS.VAST_MEDIA_LOAD_TIMEOUT.formatMessage(Math.floor(this._options.loadVideoTimeout/1e3%60)))}),this._options.loadVideoTimeout)},n.prototype.updateVPAIDProgress=function(){this._attributes.remainingTime=this._isCreativeFunctionInvokable("getAdRemainingTime")?this._vpaidCreative.getAdRemainingTime():-1,isNaN(this._attributes.remainingTime)||1===this._attributes.remainingTime||(this._attributes.currentTime=this._attributes.duration-this._attributes.remainingTime,this._vastTracker.setProgress(this._attributes.currentTime))},n.prototype.startVPAIDProgress=function(){this.stopVPAIDProgress(),this._vpaidProgressTimer=setInterval((()=>{this._isVPAID&&this._vpaidCreative&&this._vastTracker?this.updateVPAIDProgress():this.stopVPAIDProgress()}),1e3)},n.prototype.stopVPAIDProgress=function(){this._vpaidProgressTimer&&(clearInterval(this._vpaidProgressTimer),this._vpaidProgressTimer=null)},n.prototype.addEventListener=function(e,t,i){const n=t.bind(i);this._eventCallbacks[e]=n},n.prototype.removeEventListener=function(e){this._eventCallbacks[e]=null},n.prototype.removeEventListeners=function(e){for(const t in e)e.hasOwnProperty(t)&&this.removeEventListener(t)},n.prototype.onAdsManagerLoaded=function(){this.EVENTS.AdsManagerLoaded in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdsManagerLoaded]&&this._eventCallbacks[this.EVENTS.AdsManagerLoaded]()},n.prototype.onAdLoaded=function(){this.stopVASTMediaLoadTimeout(),this.EVENTS.AdLoaded in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdLoaded]&&this._eventCallbacks[this.EVENTS.AdLoaded](this._creative)},n.prototype.onAdDurationChange=function(){this._isVPAID&&this._vpaidCreative&&this._vastTracker&&(this._attributes.duration=this._isCreativeFunctionInvokable("getAdDuration")?this._vpaidCreative.getAdDuration():-1,-1!==this._attributes.duration&&this._vastTracker.setDuration(this._attributes.duration)),this.EVENTS.AdDurationChange in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdDurationChange]&&this._eventCallbacks[this.EVENTS.AdDurationChange]()},n.prototype.onAdSizeChange=function(){this.EVENTS.AdSizeChange in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdSizeChange]&&this._eventCallbacks[this.EVENTS.AdSizeChange]()},n.prototype.onAdStarted=function(){this.showSlot(),this.EVENTS.AdStarted in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdStarted]&&this._eventCallbacks[this.EVENTS.AdStarted]()},n.prototype.onAdVideoStart=function(){this._isVPAID&&this._vpaidCreative&&this._vastTracker&&this.updateVPAIDProgress(),this.EVENTS.AdVideoStart in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdVideoStart]&&this._eventCallbacks[this.EVENTS.AdVideoStart]()},n.prototype.onAdStopped=function(){this.EVENTS.AdStopped in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdStopped]&&this._eventCallbacks[this.EVENTS.AdStopped](),this._abort()},n.prototype.onAdSkipped=function(){this.EVENTS.AdSkipped in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdSkipped]&&this._eventCallbacks[this.EVENTS.AdSkipped](),this._abort()},n.prototype.onAdVolumeChange=function(){this.EVENTS.AdVolumeChange in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdVolumeChange]&&this._eventCallbacks[this.EVENTS.AdVolumeChange]()},n.prototype.onAdImpression=function(){this._isVPAID&&this._vpaidCreative&&this._vastTracker&&(this._hasImpression||(this._attributes.duration=this._isCreativeFunctionInvokable("getAdDuration")?this._vpaidCreative.getAdDuration():-1,-1!==this._attributes.duration&&this._vastTracker.setDuration(this._attributes.duration),this._vastTracker.trackImpression(),this.startVPAIDProgress(),this._hasImpression=!0)),this.EVENTS.AdImpression in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdImpression]&&this._eventCallbacks[this.EVENTS.AdImpression]()},n.prototype.onAdClickThru=function(e,t,i){this._isVPAID&&this._vpaidCreative&&this._vastTracker&&this._vastTracker.click(),this.EVENTS.AdClickThru in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdClickThru]&&this._eventCallbacks[this.EVENTS.AdClickThru](e,t,i)},n.prototype.onAdVideoFirstQuartile=function(){this._isVPAID&&this._vpaidCreative&&this._vastTracker&&this.updateVPAIDProgress(),this.EVENTS.AdVideoFirstQuartile in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdVideoFirstQuartile]&&this._eventCallbacks[this.EVENTS.AdVideoFirstQuartile]()},n.prototype.onAdVideoMidpoint=function(){this._isVPAID&&this._vpaidCreative&&this._vastTracker&&this.updateVPAIDProgress(),this.EVENTS.AdVideoMidpoint in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdVideoMidpoint]&&this._eventCallbacks[this.EVENTS.AdVideoMidpoint]()},n.prototype.onAdVideoThirdQuartile=function(){this._isVPAID&&this._vpaidCreative&&this._vastTracker&&this.updateVPAIDProgress(),this.EVENTS.AdVideoThirdQuartile in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdVideoThirdQuartile]&&this._eventCallbacks[this.EVENTS.AdVideoThirdQuartile]()},n.prototype.onAdPaused=function(){this._vastTracker&&this._vastTracker.setPaused(!0),this.EVENTS.AdPaused in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdPaused]&&this._eventCallbacks[this.EVENTS.AdPaused]()},n.prototype.onAdPlaying=function(){this._vastTracker&&this._vastTracker.setPaused(!1),this.EVENTS.AdPlaying in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdPlaying]&&this._eventCallbacks[this.EVENTS.AdPlaying]()},n.prototype.onAdVideoComplete=function(){this._isVPAID&&this._vpaidCreative&&this._vastTracker&&this._vastTracker.complete(),this.EVENTS.AdVideoComplete in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdVideoComplete]&&this._eventCallbacks[this.EVENTS.AdVideoComplete]()},n.prototype.onAllAdsCompleted=function(){this.EVENTS.AllAdsCompleted in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AllAdsCompleted]&&this._eventCallbacks[this.EVENTS.AllAdsCompleted]()},n.prototype.onAdError=function(e){this._hasError=!0,this.abort(),this.EVENTS.AdError in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdError]&&this._eventCallbacks[this.EVENTS.AdError]("object"!=typeof e?new i(e):e)},n.prototype.onAdLog=function(e){this.EVENTS.AdLog in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.EVENTS.AdLog]&&this._eventCallbacks[this.EVENTS.AdLog](e)},n.prototype.processVASTResponse=function(t){const i=t.ads;0!=i.length?(i.length>1?(this._adPod=i.sort((function(e,t){let i=e.sequence,n=t.sequence;return i===n?0:null===i?1:null===n||i<n?-1:i>n?1:0})),this._ad=i[0]):this._ad=i[0],this._ad&&(this._creative=i[0].creatives.filter((e=>"linear"===e.type))[0],this._creative&&(0!=this._creative.mediaFiles.length?(this._mediaFiles=this._creative.mediaFiles.filter((e=>this.canPlayVideoType(e.mimeType)||"application/javascript"===e.mimeType?e:void 0)),this._mediaFiles.sort((function(e,t){let i=e.height,n=t.height;return i<n?-1:i>n?1:0})),this._mediaFiles&&0!=this._mediaFiles.length?(this._vastTracker=new e.VASTTracker(null,this._ad,this._creative),this._vastTracker.load(),this.onAdsManagerLoaded()):this.onAdError(this.ERRORS.VAST_LINEAR_ASSET_MISMATCH)):this.onAdError(this.ERRORS.VAST_ASSET_NOT_FOUND)))):this.onAdError(this.ERRORS.VAST_EMPTY_RESPONSE)},n.prototype.requestAds=function(t,i={}){if(this._isDestroyed)return;this._requestId=(new Date).getTime(),Object.assign(this._options,i);const n={timeout:this._options.vastLoadTimeout,withCredentials:this._options.withCredentials,wrapperLimit:this._options.wrapperLimit,resolveAll:this._options.resolveAll};if(this.abort(),t&&"string"==typeof t){let i=!1;try{new URL(t),i=!0}catch(e){}if(i)this._vastClient=new e.VASTClient,this._vastClient.get(t,n).then((e=>{this.processVASTResponse(e)})).catch((e=>{this.onAdError(e.message)}));else{const i=(new window.DOMParser).parseFromString(t,"text/xml");this._vastParser=new e.VASTParser,this._vastParser.parseVAST(i,n).then((e=>{this.processVASTResponse(e)})).catch((e=>{this.onAdError(e.message)}))}}else this.onAdError("VAST URL/XML is empty")},n.prototype.canPlayVideoType=function(e){return!!("video/3gpp"===e&&this.supportsThreeGPVideo()||"video/webm"===e&&this.supportsWebmVideo()||"video/ogg"===e&&this.supportsOggTheoraVideo()||"video/mp4"===e&&this.supportsH264BaselineVideo())},n.prototype.supportsVideo=function(){return!!document.createElement("video").canPlayType},n.prototype.supportsH264BaselineVideo=function(){return!!this.supportsVideo()&&document.createElement("video").canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')},n.prototype.supportsOggTheoraVideo=function(){return!!this.supportsVideo()&&document.createElement("video").canPlayType('video/ogg; codecs="theora, vorbis"')},n.prototype.supportsWebmVideo=function(){return!!this.supportsVideo()&&document.createElement("video").canPlayType('video/webm; codecs="vp8, vorbis"')},n.prototype.supportsThreeGPVideo=function(){return!!this.supportsVideo()&&document.createElement("video").canPlayType('video/3gpp; codecs="mp4v.20.8, samr"')},n.prototype.handshakeVersion=function(e){return this._vpaidCreative.handshakeVersion(e)},n.prototype._isCreativeFunctionInvokable=function(e){return!!this._vpaidCreative&&(e=this._vpaidCreative[e])&&"function"==typeof e},n.prototype.checkVPAIDInterface=function(e){const t={passed:!0,missingInterfaces:""};for(let i=e.length-1;0<=i;i--)this._isCreativeFunctionInvokable(e[i])||(t.passed=!1,t.missingInterfaces+=e[i]+" ");return t},n.prototype.setCallbacksForCreative=function(e,t){for(const i in e)e.hasOwnProperty(i)&&this._vpaidCreative.subscribe(e[i],i,t)},n.prototype.removeCallbacksForCreative=function(e){if(null!==this._vpaidCreative)for(const t in e)e.hasOwnProperty(t)&&this._vpaidCreative.unsubscribe(t)},n.prototype.creativeAssetLoaded=function(){if(function(e){const t=e.checkVPAIDInterface("handshakeVersion initAd startAd stopAd subscribe unsubscribe getAdLinear".split(" "));return t.passed||e.onAdError("Missing interfaces in the VPAID creative: "+t.missingInterfaces),t.passed}(this)&&(()=>{const e=this.handshakeVersion(this.SUPPORTED_CREATIVE_VPAID_VERSION_MIN.toFixed(1));return e?!(parseFloat(e)<this.SUPPORTED_CREATIVE_VPAID_VERSION_MIN&&(this.onAdError("Only support creatives with VPAID version >= "+this.SUPPORTED_CREATIVE_VPAID_VERSION_MIN.toFixed(1)),1)):(this.onAdError("Cannot get VPAID version from the creative"),!1)})()){this._creativeEventCallbacks={AdStarted:this.onAdStarted,AdStopped:this.onAdStopped,AdSkipped:this.onAdSkipped,AdLoaded:this.onAdLoaded,AdSizeChange:this.onAdSizeChange,AdDurationChange:this.onAdDurationChange,AdVolumeChange:this.onAdVolumeChange,AdImpression:this.onAdImpression,AdClickThru:this.onAdClickThru,AdVideoStart:this.onAdVideoStart,AdVideoFirstQuartile:this.onAdVideoFirstQuartile,AdVideoMidpoint:this.onAdVideoMidpoint,AdVideoThirdQuartile:this.onAdVideoThirdQuartile,AdVideoComplete:this.onAdVideoComplete,AdPaused:this.onAdPaused,AdPlaying:this.onAdPlaying,AdError:this.onAdError,AdLog:this.onAdLog},this.setCallbacksForCreative(this._creativeEventCallbacks,this);const e=this._attributes.width,t=this._attributes.height,i={AdParameters:this._creative.adParameters},n={slot:this._slot,videoSlot:this._videoSlot,videoSlotCanAutoPlay:!0};this.startVASTMediaLoadTimeout(),this._vpaidCreative.initAd(e,t,this._attributes.viewMode,this._attributes.desiredBitrate,i,n)}},n.prototype.handleLoadCreativeMessage=function(e){if(e&&e.data){const t=String(e.data).match(new RegExp("adm:"+this._requestId+"://(.*)"));if(t){const i=JSON.parse(t[1]);if("load"==i)try{let e=this._vpaidIframe.contentWindow.getVPAIDAd;e&&"function"==typeof e?(e=e(),void 0===e?this.onAdError("getVPAIDAd() returns undefined value"):null==e?this.onAdError("getVPAIDAd() returns null"):(this._vpaidCreative=e,this.creativeAssetLoaded())):this.onAdError("getVPAIDAd() is undefined")}catch(e){this.onAdError(e)}else"error"==i&&this.onAdError("Error load VPAID")}}},n.prototype.loadCreativeAsset=function(e){window.addEventListener("message",this._handleLoadCreativeMessage),this._vpaidIframe=document.createElement("iframe"),this._vpaidIframe.style.display="none",this._vpaidIframe.style.width="0px",this._vpaidIframe.style.height="0px",this._adContainer.appendChild(this._vpaidIframe),this._vpaidIframe.contentWindow.document.open(),this._vpaidIframe.contentWindow.document.write(`\n    <script>function sendMessage(msg) {\n    window.parent.postMessage('adm:${this._requestId}://' + JSON.stringify(msg), '*'); }\n     <\/script>\n    <script type="text/javascript" onload="sendMessage('load')" onerror="sendMessage('error')" src="${e}"> <\/script>\n  `),this._vpaidIframe.contentWindow.document.close()},n.prototype.removeCreativeAsset=function(){this._vpaidIframe&&this._vpaidIframe.parentNode.removeChild(this._vpaidIframe),[...this._slot.children].forEach((e=>{e!==this._videoSlot&&this._slot.removeChild(e)}))},n.prototype._abort=function(){this.abort(),this.onAllAdsCompleted()},n.prototype.isCreativeExists=function(){return this._creative&&0!=this._creative.mediaFiles.length},n.prototype.handleSlotClick=function(){!this._isVPAID&&this._vastTracker&&this._vastTracker.click()},n.prototype.handleVideoSlotError=function(){this.onAdError(this.ERRORS.VIDEO_PLAY_ERROR)},n.prototype.handleVideoSlotCanPlay=function(){},n.prototype.handleVideoSlotVolumeChange=function(e){this._vastTracker&&this._vastTracker.setMuted(e.target.muted)},n.prototype.handleVideoSlotTimeUpdate=function(e){if(this.isCreativeExists()){if(this._nextQuartileIndex>=this._quartileEvents.length)return;const t=100*e.target.currentTime/e.target.duration;if(t>=this._quartileEvents[this._nextQuartileIndex].value){const e=this._quartileEvents[this._nextQuartileIndex].event;this._defaultEventCallbacks[e](),this._nextQuartileIndex+=1}t>=0&&(this._hasImpression||(this._vastTracker&&this._vastTracker.trackImpression(),this._hasImpression=!0)),this._vastTracker&&this._vastTracker.setProgress(e.target.currentTime),e.target.duration>0&&(this._attributes.remainingTime=e.target.duration-e.target.currentTime)}},n.prototype.handleVideoSlotLoadedMetaData=function(e){this._attributes.duration=e.target.duration,this._vastTracker&&this._vastTracker.setDuration(e.target.duration),this.onAdDurationChange()},n.prototype.handleVideoSlotEnded=function(){this._vastTracker&&this._vastTracker.complete(),this.onAdStopped()},n.prototype.init=function(e,t,i){this._isDestroyed||this.isCreativeExists()&&(this._options.muted&&(this._videoSlot.muted=!0,this._videoSlot.volume=0),this._mediaFileIndex=this._mediaFiles.findIndex((function(e){return e.height>=t})),-1!=this._mediaFileIndex?this._mediaFile=this._mediaFiles[this._mediaFileIndex]:this._mediaFile=this._mediaFiles[this._mediaFiles.length-1],this._mediaFile&&("application/javascript"===this._mediaFile.mimeType&&(this._isVPAID=!0),this._attributes.width=e,this._attributes.height=t,this._attributes.viewMode=i,this.resizeSlot(this._attributes.width,this._attributes.height),this._videoSlot.addEventListener("error",this._handleVideoSlotError,!1),this._isVPAID?this.loadCreativeAsset(this._mediaFile.fileURL):(this._slot.addEventListener("click",this._handleSlotClick),this._videoSlot.addEventListener("canplay",this._handleVideoSlotCanPlay),this._videoSlot.addEventListener("volumechange",this._handleVideoSlotVolumeChange),this._videoSlot.addEventListener("timeupdate",this._handleVideoSlotTimeUpdate,!0),this._videoSlot.addEventListener("loadedmetadata",this._handleVideoSlotLoadedMetaData),this._videoSlot.addEventListener("ended",this._handleVideoSlotEnded),this._videoSlot.setAttribute("src",this._mediaFile.fileURL),this.onAdLoaded()),this._vastTracker&&this._vastTracker.on("clickthrough",(e=>{this._isVPAID||this.onAdClickThru(e);const t=window.open(e,"_blank");void 0!==t?t.focus():window.location.href=e}))))},n.prototype.start=function(){if(this.isCreativeExists())if(this._isVPAID)this._isCreativeFunctionInvokable("startAd")&&this._vpaidCreative.startAd();else{this._videoSlot.load();const e=this._videoSlot.play();void 0!==e&&e.then((e=>{})).catch((e=>{this._videoSlot.play()})),this.onAdStarted()}},n.prototype.getDuration=function(){return this.isCreativeExists()&&this._attributes.duration},n.prototype.pause=function(){this.isCreativeExists()&&(this._isVPAID?this._isCreativeFunctionInvokable("pauseAd")&&this._vpaidCreative.pauseAd():(this._videoSlot.pause(),this.onAdPaused()))},n.prototype.resume=function(){this.isCreativeExists()&&(this._isVPAID?this._isCreativeFunctionInvokable("resumeAd")&&this._vpaidCreative.resumeAd():(this._videoSlot.play(),this.onAdPlaying()))},n.prototype.stop=function(){this.isCreativeExists()&&(this._isVPAID?this._isCreativeFunctionInvokable("stopAd")&&this._vpaidCreative.stopAd():this.onAdStopped())},n.prototype.skip=function(){this.isCreativeExists()&&(this._isVPAID?this._isCreativeFunctionInvokable("skipAd")&&this._vpaidCreative.skipAd():this.onAdSkipped())},n.prototype.resize=function(e,t,i){this.isCreativeExists()&&(this._attributes.width=e,this._attributes.height=t,this._attributes.viewMode=i,this.resizeSlot(this._attributes.width,this._attributes.height),this._isVPAID?this._isCreativeFunctionInvokable("resizeAd")&&this._vpaidCreative.resizeAd(e,t,i):this.onAdSizeChange())},n.prototype.getVolume=function(){if(this.isCreativeExists())return this._isVPAID?this._isCreativeFunctionInvokable("getAdVolume")?this._vpaidCreative.getAdVolume():-1:this._videoSlot.volume},n.prototype.setVolume=function(e){this.isCreativeExists()&&(this._isVPAID?this._isCreativeFunctionInvokable("setAdVolume")&&this._vpaidCreative.setAdVolume(e):e!==this._videoSlot.volume&&(this._attributes.volume=e,this._videoSlot.volume=e,this.onAdVolumeChange()))},n.prototype.getRemainingTime=function(){if(this.isCreativeExists())return this._isVPAID?this._isCreativeFunctionInvokable("getAdRemainingTime")?this._vpaidCreative.getAdRemainingTime():-1:this._attributes.remainingTime},n.prototype.collapse=function(){this.isCreativeExists()&&this._isVPAID&&this._isCreativeFunctionInvokable("collapseAd")&&this._vpaidCreative.collapseAd()},n.prototype.expand=function(){this.isCreativeExists()&&this._isVPAID&&this._isCreativeFunctionInvokable("expandAd")&&this._vpaidCreative.expandAd()},n.prototype.abort=function(){this._isDestroyed||(window.removeEventListener("message",this._handleLoadCreativeMessage),this.stopVASTMediaLoadTimeout(),this.stopVPAIDProgress(),this._isVPAID&&(this.removeCallbacksForCreative(this._creativeEventCallbacks),this.removeCreativeAsset()),this._nextQuartileIndex=0,this._isVPAID=!1,this._hasLoaded=!1,this._hasError=!1,this._hasImpression=!1,this._hasStarted=!1,this._ad=null,this._creative=null,this._mediaFile=null,this._vpaidCreative=null,this._vastTracker=null,this._slot.removeEventListener("click",this._handleSlotClick),this._videoSlot.removeEventListener("error",this._handleVideoSlotError,!1),this._videoSlot.removeEventListener("canplay",this._handleVideoSlotCanPlay),this._videoSlot.removeEventListener("volumechange",this._handleVideoSlotVolumeChange),this._videoSlot.removeEventListener("timeupdate",this._handleVideoSlotTimeUpdate,!0),this._videoSlot.removeEventListener("loadedmetadata",this._handleVideoSlotLoadedMetaData),this._videoSlot.removeEventListener("ended",this._handleVideoSlotEnded),this._videoSlot.pause(),this._videoSlot.removeAttribute("src"),this._videoSlot.load(),this.hideSlot())},n.prototype.destroy=function(){this._isDestroyed||(this.abort(!1),this.removeEventListeners(this._eventCallbacks),this.removeSlot(),this._adContainer=null,this._slot=null,this._videoSlot=null,this._isDestroyed=!0)},n.prototype.isDestroyed=function(){return this._isDestroyed},n.prototype.getVersion=function(){return this._attributes.version}})();var d=o.h;const l=function(e,t){this._adContainer=e,this._videoElement=t,this.EVENTS={AdsManagerLoaded:"AdsManagerLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdLoaded:"AdLoaded",AdLinearChange:"AdLinearChange",AdSizeChange:"AdSizeChange",AdExpandedChange:"AdExpandedChange",AdSkippableStateChange:"AdSkippableStateChange",AdDurationChange:"AdDurationChange",AdRemainingTimeChange:"AdRemainingTimeChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdError:"AdError",AdLog:"AdLog",AllAdsCompleted:"AllAdsCompleted"},this._eventCallbacks={},this.IMA_SDK_SRC="//imasdk.googleapis.com/js/sdkloader/ima3.js",window.google&&google.ima&&google.ima.AdsLoader?this.setupIMA():function(e,t=!1,i){const n=document.getElementsByTagName("head")[0]||document.documentElement,r=document.createElement("script");r.type="text/javascript",r.src=e,r.async=t,r.addEventListener("load",(function(){i&&"function"==typeof i&&i(!0,window)}),!1),r.addEventListener("error",(function(){n.removeChild(r),i&&"function"==typeof i&&i(!1)}),!1),n.insertBefore(r,n.firstChild)}(this.IMA_SDK_SRC,!0,(e=>{e&&this.setupIMA()})),this._adsLoader=null,this._adDisplayContainer=null,this._adDisplayContainerInitialized=!1,this._adsManager=null,this._currentAd=null,this._adPodInfo=null,this._attributes={volume:0},this._options={autoplay:!0,muted:!0,secure:!1,vastLoadTimeout:23e3,loadVideoTimeout:8e3}};l.prototype.setupIMA=function(){google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),this._adDisplayContainer=new google.ima.AdDisplayContainer(this._adContainer,this._videoElement),this._adsLoader=new google.ima.AdsLoader(this._adDisplayContainer),this._adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onIMAAdsManagerLoaded.bind(this),!1),this._adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onIMAAdsManagerAdError.bind(this),!1)},l.prototype.doContentComplete=function(){this._adsLoader&&this._adsLoader.contentComplete()},l.prototype.maybeInitializeAdDisplayContainer=function(){this._adDisplayContainerInitialized||(this._adDisplayContainer.initialize(),this._adDisplayContainerInitialized=!0)},l.prototype.init=function(e,t,i){this.maybeInitializeAdDisplayContainer(),this._adsManager&&this._adsManager.init(e,t,i)},l.prototype.start=function(){this._adsManager&&this._adsManager.start()},l.prototype.getDuration=function(){return this._currentAd?this._currentAd.getDuration():-2},l.prototype.getRemainingTime=function(){return this._adsManager?this._adsManager.getRemainingTime():-2},l.prototype.resume=function(){this._adsManager&&this._adsManager.resume()},l.prototype.pause=function(){this._adsManager&&this._adsManager.pause()},l.prototype.stop=function(){this._adsManager&&this._adsManager.stop()},l.prototype.skip=function(){this._adsManager&&this._adsManager.skip()},l.prototype.resize=function(e,t,i){this._adsManager&&(this._adsManager.resize(e,t,i),this.onAdSizeChange())},l.prototype.getVolume=function(){return this._adsManager&&this._adsManager.getVolume()},l.prototype.setAdVolume=function(e){this._adsManager&&this._adsManager.setVolume(e)},l.prototype.collapse=function(){this._adsManager&&this._adsManager.collapse()},l.prototype.expand=function(){this._adsManager&&this._adsManager.expand()},l.prototype.requestAds=function(e,t){Object.assign(this._options,t);const i=new google.ima.AdsRequest;let n=!1;try{new URL(e),n=!0}catch(e){}n?i.adTagUrl=e:i.adsResponse=e,this._options.pageUrl&&(i.pageUrl=this._options.pageUrl),i.vastLoadTimeout=this._options.vastLoadTimeout,i.linearAdSlotWidth=this._videoElement.width,i.linearAdSlotHeight=this._videoElement.height,i.nonLinearAdSlotWidth=this._videoElement.width,i.nonLinearAdSlotHeight=150,i.setAdWillAutoPlay(this._options.autoplay),this._options.muted&&i.setAdWillPlayMuted(this._options.muted),this._adsLoader.getSettings().setVpaidMode(this._options.secure?google.ima.ImaSdkSettings.VpaidMode.ENABLED:google.ima.ImaSdkSettings.VpaidMode.INSECURE),this._adsLoader.requestAds(i)},l.prototype.abort=function(){this._adsManager&&(this._adsManager.destroy(),this._adsManager=null),this.doContentComplete()},l.prototype.onIMAAdsManagerLoaded=function(e){const t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.loadVideoTimeout=this._options.loadVideoTimeout,this._adsManager=e.getAdsManager(this._videoElement,t),this._adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onIMAAdError.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.AD_BREAK_READY,(function(){})),this._adsManager.addEventListener(google.ima.AdEvent.Type.AD_METADATA,(function(){})),this._adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,this.onAllAdsCompleted.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.CLICK,this.onIMAAdClickThru.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,this.onIMAAdVideoComplete.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,this.onAdStarted.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,this.onAdStopped.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.DURATION_CHANGE,this.onAdDurationChange.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.FIRST_QUARTILE,this.onAdVideoFirstQuartile.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.IMPRESSION,this.onAdImpression.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.INTERACTION,this.onAdInteraction.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.LINEAR_CHANGED,this.onAdLinearChange.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,this.onIMAAdLoaded.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.LOG,this.onIMAAdLog.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.MIDPOINT,this.onAdVideoMidpoint.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.PAUSED,this.onAdPaused.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.RESUMED,this.onAdPlaying.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,this.onAdSkippableStateChange.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED,this.onIMAAdSkipped.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,this.onAdVideoStart.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.THIRD_QUARTILE,this.onAdVideoThirdQuartile.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.USER_CLOSE,this.onAdUserClose.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.VOLUME_CHANGED,this.onAdVolumeChange.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.VOLUME_MUTED,this.onAdVolumeChange.bind(this)),this.onAdsManagerLoaded()},l.prototype.onIMAAdsManagerAdError=function(e){this.abort(),this.onAdError(e.getError())},l.prototype.onIMAAdClickThru=function(e){this.onAdClickThru("",e.getAd().getAdId(),!1)},l.prototype.onIMAAdVideoComplete=function(){this.onAdVideoComplete()},l.prototype.onIMAAdLoaded=function(e){this._currentAd=e.getAd(),this.onAdLoaded()},l.prototype.onIMAAdSkipped=function(){this.abort(),this.onAdSkipped(),this.onAdStopped()},l.prototype.onIMAAdError=function(e){this.abort(),this.onAdError(e.getError())},l.prototype.onIMAAdLog=function(e){(e=e.getAdData()).hasOwnProperty("adError")?this.onAdLog(e.adError.getMessage()):this.onAdLog("IMA Ad Log")},l.prototype.onAdsManagerLoaded=function(){this._callEvent(this.EVENTS.AdsManagerLoaded)},l.prototype.onAdLoaded=function(){this.EVENTS.AdLoaded in this._eventCallbacks&&this._eventCallbacks[this.EVENTS.AdLoaded](this._currentAd)},l.prototype.onAdStarted=function(){this._callEvent(this.EVENTS.AdStarted)},l.prototype.onAdDurationChange=function(){this._callEvent(this.EVENTS.AdDurationChange)},l.prototype.onAdLinearChange=function(){this._callEvent(this.EVENTS.AdLinearChange)},l.prototype.onAdSkippableStateChange=function(){this._callEvent(this.EVENTS.AdSkippableStateChange)},l.prototype.onAdSizeChange=function(){this._callEvent(this.EVENTS.AdSizeChange)},l.prototype.onAdVolumeChange=function(){this._callEvent(this.EVENTS.AdVolumeChange)},l.prototype.onAdVideoStart=function(){this._callEvent(this.EVENTS.AdVideoStart)},l.prototype.onAdImpression=function(){this._callEvent(this.EVENTS.AdImpression)},l.prototype.onAdVideoFirstQuartile=function(){this._callEvent(this.EVENTS.AdVideoFirstQuartile)},l.prototype.onAdVideoMidpoint=function(){this._callEvent(this.EVENTS.AdVideoMidpoint)},l.prototype.onAdVideoThirdQuartile=function(){this._callEvent(this.EVENTS.AdVideoThirdQuartile)},l.prototype.onAdVideoComplete=function(){this._callEvent(this.EVENTS.AdVideoComplete)},l.prototype.onAdPaused=function(){this._callEvent(this.EVENTS.AdPaused)},l.prototype.onAdPlaying=function(){this._callEvent(this.EVENTS.AdPlaying)},l.prototype.onAdSkipped=function(){this._callEvent(this.EVENTS.AdSkipped)},l.prototype.onAdStopped=function(){this._callEvent(this.EVENTS.AdStopped)},l.prototype.onAdClickThru=function(e,t,i){this.EVENTS.AdClickThru in this._eventCallbacks&&this._eventCallbacks[this.EVENTS.AdClickThru](e,t,i)},l.prototype.onAdInteraction=function(){this._callEvent(this.EVENTS.AdInteraction)},l.prototype.onAdUserClose=function(){this._callEvent(this.EVENTS.AdUserClose)},l.prototype.onAllAdsCompleted=function(){this.abort(),this._callEvent(this.EVENTS.AllAdsCompleted)},l.prototype.onAdError=function(e){this.EVENTS.AdError in this._eventCallbacks&&this._eventCallbacks[this.EVENTS.AdError](e)},l.prototype.onAdLog=function(e){this.EVENTS.AdLog in this._eventCallbacks&&this._eventCallbacks[this.EVENTS.AdLog](e)},l.prototype._callEvent=function(e){e in this._eventCallbacks&&this._eventCallbacks[e]()},l.prototype.addEventListener=function(e,t,i){const n=t.bind(i);this._eventCallbacks[e]=n},l.prototype.removeEventListener=function(e){this._eventCallbacks[e]=null};const h=l,u=function(e,t){if(!(e instanceof Element||e instanceof HTMLDocument)||!(t instanceof Element||t instanceof HTMLDocument))throw new Error("ad container and/or video element not defined");this._adContainer=e,this._videoElement=t,this._attributes={width:300,height:154,viewMode:"normal",volume:0,version:"1.0.1"},this.EVENTS={AdsManagerLoaded:"AdsManagerLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdLoaded:"AdLoaded",AdLinearChange:"AdLinearChange",AdSizeChange:"AdSizeChange",AdExpandedChange:"AdExpandedChange",AdSkippableStateChange:"AdSkippableStateChange",AdDurationChange:"AdDurationChange",AdRemainingTimeChange:"AdRemainingTimeChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdError:"AdError",AdLog:"AdLog",AllAdsCompleted:"AllAdsCompleted"},this._eventCallbacks={},this._adsManager=new d(this._adContainer),this._adsManager.addEventListener(this.EVENTS.AdsManagerLoaded,this.onAdsManagerLoaded.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdError,this.onAdError.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdLog,this.onAdLog.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdLoaded,this.onAdLoaded.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdStarted,this.onAdStarted.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdDurationChange,this.onAdDurationChange.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdLinearChange,this.onAdLinearChange.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdSkippableStateChange,this.onAdSkippableStateChange.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdSizeChange,this.onAdSizeChange.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdVolumeChange,this.onAdVolumeChange.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdVideoStart,this.onAdVideoStart.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdImpression,this.onAdImpression.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdVideoFirstQuartile,this.onAdVideoFirstQuartile.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdVideoMidpoint,this.onAdVideoMidpoint.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdVideoThirdQuartile,this.onAdVideoThirdQuartile.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdVideoComplete,this.onAdVideoComplete.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdPaused,this.onAdPaused.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdPlaying,this.onAdPlaying.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdSkipped,this.onAdSkipped.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdStopped,this.onAdStopped.bind(this)),this._adsManager.addEventListener(this.EVENTS.AdClickThru,this.onAdClickThru.bind(this)),this._adsManager.addEventListener(this.EVENTS.AllAdsCompleted,this.onAllAdsCompleted.bind(this)),this._imaWrapper=new h(this._adContainer,this._videoElement),this._imaWrapper.addEventListener(this.EVENTS.AdsManagerLoaded,this.onAdsManagerLoaded.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdLog,this.onAdLog.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdError,this.onAdError.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdLoaded,this.onAdLoaded.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdStarted,this.onAdStarted.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdDurationChange,this.onAdDurationChange.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdLinearChange,this.onAdLinearChange.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdSkippableStateChange,this.onAdSkippableStateChange.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdSizeChange,this.onAdSizeChange.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdVolumeChange,this.onAdVolumeChange.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdVideoStart,this.onAdVideoStart.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdImpression,this.onAdImpression.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdVideoFirstQuartile,this.onAdVideoFirstQuartile.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdVideoMidpoint,this.onAdVideoMidpoint.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdVideoThirdQuartile,this.onAdVideoThirdQuartile.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdVideoComplete,this.onAdVideoComplete.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdPaused,this.onAdPaused.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdPlaying,this.onAdPlaying.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdSkipped,this.onAdSkipped.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdStopped,this.onAdStopped.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AdClickThru,this.onAdClickThru.bind(this)),this._imaWrapper.addEventListener(this.EVENTS.AllAdsCompleted,this.onAllAdsCompleted.bind(this)),this._useIMA=!1};u.prototype.init=function(e,t,i){this._useIMA?this._imaWrapper.init(e,t,i):this._adsManager.init(e,t,i)},u.prototype.start=function(){this._useIMA?this._imaWrapper.start():this._adsManager.start()},u.prototype.getDuration=function(){return this._useIMA?this._imaWrapper.getDuration():this._adsManager.getDuration()},u.prototype.getRemainingTime=function(){return this._useIMA?this._imaWrapper.getRemainingTime():this._adsManager.getRemainingTime()},u.prototype.resume=function(){this._useIMA?this._imaWrapper.resume():this._adsManager.resume()},u.prototype.pause=function(){this._useIMA?this._imaWrapper.pause():this._adsManager.pause()},u.prototype.stop=function(){this._useIMA?this._imaWrapper.stop():this._adsManager.stop()},u.prototype.skip=function(){this._useIMA?this._imaWrapper.skip():this._adsManager.skip()},u.prototype.resize=function(e,t,i){this._useIMA?this._imaWrapper.resize(e,t,i):this._adsManager.resize(e,t,i)},u.prototype.getVolume=function(){return this._useIMA?this._imaWrapper.getVolume():this._adsManager.getVolume()},u.prototype.setVolume=function(e){this._useIMA?this._imaWrapper.setVolume(e):this._adsManager.setVolume(e)},u.prototype.collapse=function(){this._useIMA?this._imaWrapper.collapse():this._adsManager.collapse()},u.prototype.expand=function(){this._useIMA?this._imaWrapper.expand():this._adsManager.expand()},u.prototype.requestAds=function(e,t={}){this.abort(),e&&"string"==typeof e?(-1!==e.indexOf("pubads.g.doubleclick.net")?this._useIMA=!0:this._useIMA=!1,this._useIMA?this._imaWrapper.requestAds(e,t):this._adsManager.requestAds(e,t)):this.onAdError("VAST URL/XML is empty")},u.prototype.abort=function(){this._useIMA?this._imaWrapper.abort():this._adsManager.abort()},u.prototype.onAdsManagerLoaded=function(){this._callEvent(this.EVENTS.AdsManagerLoaded)},u.prototype.onAdError=function(e){this.EVENTS.AdError in this._eventCallbacks&&this._eventCallbacks[this.EVENTS.AdError]("object"!=typeof e?new n(e):e)},u.prototype.onAdLog=function(e){this.EVENTS.AdLog in this._eventCallbacks&&this._eventCallbacks[this.EVENTS.AdLog](e)},u.prototype.onAdLoaded=function(e){this.EVENTS.AdLoaded in this._eventCallbacks&&this._eventCallbacks[this.EVENTS.AdLoaded](e)},u.prototype.onAdStarted=function(){this._callEvent(this.EVENTS.AdStarted)},u.prototype.onAdDurationChange=function(){this._callEvent(this.EVENTS.AdDurationChange)},u.prototype.onAdLinearChange=function(){this._callEvent(this.EVENTS.AdLinearChange)},u.prototype.onAdSkippableStateChange=function(){this._callEvent(this.EVENTS.AdSkippableStateChange)},u.prototype.onAdSizeChange=function(){this._callEvent(this.EVENTS.AdSizeChange)},u.prototype.onAdVolumeChange=function(){this._callEvent(this.EVENTS.AdVolumeChange)},u.prototype.onAdVideoStart=function(){this._callEvent(this.EVENTS.AdVideoStart)},u.prototype.onAdImpression=function(){this._callEvent(this.EVENTS.AdImpression)},u.prototype.onAdVideoFirstQuartile=function(){this._callEvent(this.EVENTS.AdVideoFirstQuartile)},u.prototype.onAdVideoMidpoint=function(){this._callEvent(this.EVENTS.AdVideoMidpoint)},u.prototype.onAdVideoThirdQuartile=function(){this._callEvent(this.EVENTS.AdVideoThirdQuartile)},u.prototype.onAdVideoComplete=function(){this._callEvent(this.EVENTS.AdVideoComplete)},u.prototype.onAdPaused=function(){this._callEvent(this.EVENTS.AdPaused)},u.prototype.onAdPlaying=function(){this._callEvent(this.EVENTS.AdPlaying)},u.prototype.onAdSkipped=function(){this._callEvent(this.EVENTS.AdSkipped)},u.prototype.onAdStopped=function(){this._callEvent(this.EVENTS.AdStopped)},u.prototype.onAdClickThru=function(e,t,i){this.EVENTS.AdClickThru in this._eventCallbacks&&this._eventCallbacks[this.EVENTS.AdClickThru](e,t,i)},u.prototype.onAdInteraction=function(){this._callEvent(this.EVENTS.AdInteraction)},u.prototype.onAdUserClose=function(){this._callEvent(this.EVENTS.AdUserClose)},u.prototype.onAllAdsCompleted=function(){this._callEvent(this.EVENTS.AllAdsCompleted)},u.prototype._callEvent=function(e){e in this._eventCallbacks&&this._eventCallbacks[e]()},u.prototype.addEventListener=function(e,t,i){const n=t.bind(i);this._eventCallbacks[e]=n},u.prototype.removeEventListener=function(e){this._eventCallbacks[e]=null},u.removeEventListeners=function(e){for(const t in e)e.hasOwnProperty(t)&&this.removeEventListener(t)},u.prototype.getVersion=function(){return this._attributes.version};const c={VideoAdManagerIMAWrapper:u};adserve=t})();